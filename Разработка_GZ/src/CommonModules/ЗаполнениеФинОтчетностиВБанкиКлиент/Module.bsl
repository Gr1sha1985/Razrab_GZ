
#Область СлужебныйПрограммныйИнтерфейс

#Область РегламентированнаяОтчетность

Процедура ОткрытьФормуВыбораРегламентированногоОтчета(ПараметрыФормы, ВладелецФормы, ОписаниеОповещенияОЗакрытии) Экспорт

	ОткрытьФорму("ОбщаяФорма.ВыборРегламентированногоОтчета",
		ПараметрыФормы, ВладелецФормы, , , , ОписаниеОповещенияОЗакрытии);
		
КонецПроцедуры

#КонецОбласти

Процедура ОбновлениеФинОтчетностиЗавершение(Результат, ДополнительныеПараметры) Экспорт
	
	Если ДополнительныеПараметры.Свойство("Ключ") Тогда
		// Открывается форма существующего комплекта.
		ОткрытьФорму("Документ.ФинОтчетВБанк.ФормаОбъекта", ДополнительныеПараметры);
	Иначе
		// Открывается форма нового комплекта.
		ЭтоАрхивныйКомплект = ЗаполнениеФинОтчетностиВБанкиВызовСервера.ЭтоАрхивныйКомплект(
			ДополнительныеПараметры.ЗначенияЗаполнения.Банк,
			ДополнительныеПараметры.ЗначенияЗаполнения.ИдентификаторКомплекта);
		
		Если ЭтоАрхивныйКомплект Тогда
			ЗаполнениеФинОтчетностиВБанкиВызовСервера.ЗакончитьВыполнениеПравила(ДополнительныеПараметры.Правило);
			
			ЗначенияЗаполнения = Новый Структура("Организация, Банк, НачалоПериода, КонецПериода");
			ЗаполнитьЗначенияСвойств(ЗначенияЗаполнения, ДополнительныеПараметры.ЗначенияЗаполнения);
			ОбработчикОповещения = Новый ОписаниеОповещения("ПредупреждениеЗакрытие", ЭтотОбъект, ЗначенияЗаполнения);
			
			ПоказатьПредупреждение(ОбработчикОповещения,
				НСтр("ru = 'Выбранный комплект 1С:ФинОтчетности находится в архиве.
				|Выберите другой комплект.'"));
		Иначе
			ОткрытьФорму("Документ.ФинОтчетВБанк.ФормаОбъекта", ДополнительныеПараметры);
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ПредупреждениеЗакрытие(ДополнительныеПараметры) Экспорт
	
	ОткрытьФорму("РегистрСведений.ЖурналСтатусовФинОтчетностиВБанки.Форма.ФормаСозданияНовогоОтчета", ДополнительныеПараметры);
	
КонецПроцедуры

#КонецОбласти