#Область ПрограммныйИнтерфейс

#Область РаботаСПрикладнымиДокументами

// Проверяет номер КиЗ на валидность
//
// Параметры:
//  Значение - Строка - Проверяемый номер КиЗ
// 
// Возвращаемое значение:
//   Булево - значение является номером КиЗ
//
Функция ОшибочныйСимволВНомерКиЗ(Значение) Экспорт
	
	ДлинаСтроки = СтрДлина(Значение);
	Если ДлинаСтроки> 20 Тогда
		Возврат 21;
	КонецЕсли;
	
	РазрешеннаяДлина = Мин(ДлинаСтроки, 20);
	ШаблонБуквы = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
	ШаблонБуквыЦифры = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
	МаскаВвода = "ZZ-UUUUUU-UUUUUUUUUU";
	
	Для Сч=1 По РазрешеннаяДлина Цикл
		ТекущийСимвол = Сред(Значение, Сч, 1);
		СимволМаски = Сред(МаскаВвода, Сч, 1);
		Если СимволМаски = "Z" И СтрНайти(ШаблонБуквы, ТекущийСимвол) = 0
			ИЛИ СимволМаски = "U" И СтрНайти(ШаблонБуквыЦифры, ТекущийСимвол) = 0
			ИЛИ СимволМаски = "-" И ТекущийСимвол <> "-" Тогда
			Возврат Сч;
		КонецЕсли;
	КонецЦикла;
	
	Возврат 0;
	
КонецФункции

// Проверяет номер КиЗ на валидность
//
// Параметры:
//  Значение - Строка - Проверяемый номер КиЗ
// 
// Возвращаемое значение:
//   Булево - значение является номером КиЗ
//
Функция ЭтоКорректныйНомерКиЗ(Значение) Экспорт
	
	Возврат СтрДлина(Значение) =20 И  ОшибочныйСимволВНомерКиЗ(Значение) = 0;
	
КонецФункции

#КонецОбласти


#КонецОбласти



