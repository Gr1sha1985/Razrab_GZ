
#Область СлужебныеПроцедурыИФункции

Функция ПолучитьТекстОбщегоЗапроса(ИсточникДанных, ТолькоРазрешенные) Экспорт
	
	ТекстЗапроса = "";
	
	Если ВРег(ИсточникДанных) = ВРег("НачисленияУдержания") Тогда
		
		ТекстЗапроса = 
		"ВЫБРАТЬ
		|	ДАТАВРЕМЯ(1, 1, 1) КАК Период
		|ПОМЕСТИТЬ Представления_Периоды
		|ГДЕ
		|	""НачалоИнтервала"" = &НачалоПериода
		|	И ""ОкончаниеИнтервала"" = &КонецПериода
		|	И ""Периодичность"" = ""МЕСЯЦ""
		|	И ""ИспользоватьКонецПериода"" = ЛОЖЬ
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Сотрудник КАК Сотрудник,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.СтатьяФинансирования КАК СтатьяФинансирования,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.СтатьяРасходов КАК СтатьяРасходов,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Организация КАК Организация,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Подразделение КАК Подразделение,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.СуммаВзаиморасчетовНачальныйОстаток КАК НачальныйОстаток,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.СуммаВзаиморасчетовКонечныйОстаток КАК КонечныйОстаток,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Период КАК Период,
		|	НЕОПРЕДЕЛЕНО КАК Группа
		|ПОМЕСТИТЬ ВТОстаткиИОборотыБухгалтерскихВзаиморасчетовССотрудниками
		|ИЗ
		|	РегистрНакопления.БухгалтерскиеВзаиморасчетыССотрудниками.ОстаткиИОбороты(&НачалоПериода {(&НачалоПериода)}, &КонецПериода {(&КонецПериода)}, Месяц, , {(Сотрудник), (ФизическоеЛицо), (Организация)}) КАК БухгалтерскиеВзаиморасчетыССотрудниками
		|{ГДЕ
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Организация.*,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Сотрудник.*,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.ФизическоеЛицо.*,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.СтатьяФинансирования.*,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.СтатьяРасходов.*,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Подразделение.*,
		|	(НЕОПРЕДЕЛЕНО) КАК Группа}
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВзаиморасчетыССотрудниками.Сотрудник КАК Сотрудник,
		|	ВзаиморасчетыССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо,
		|	ВзаиморасчетыССотрудниками.СтатьяФинансирования КАК СтатьяФинансирования,
		|	ВзаиморасчетыССотрудниками.СтатьяРасходов КАК СтатьяРасходов,
		|	ВзаиморасчетыССотрудниками.Организация КАК Организация,
		|	ВзаиморасчетыССотрудниками.Подразделение КАК Подразделение,
		|	ВзаиморасчетыССотрудниками.СуммаВзаиморасчетовНачальныйОстаток КАК НачальныйОстаток,
		|	ВзаиморасчетыССотрудниками.СуммаВзаиморасчетовКонечныйОстаток КАК КонечныйОстаток,
		|	ВзаиморасчетыССотрудниками.Период КАК Период,
		|	НЕОПРЕДЕЛЕНО КАК Группа
		|ПОМЕСТИТЬ ВТОстаткиИОборотыВзаиморасчетовССотрудниками
		|ИЗ
		|	РегистрНакопления.ВзаиморасчетыССотрудниками.ОстаткиИОбороты(&НачалоПериода {(&НачалоПериода)}, &КонецПериода {(&КонецПериода)}, Месяц, , {(Сотрудник), (ФизическоеЛицо), (Организация)}) КАК ВзаиморасчетыССотрудниками
		|{ГДЕ
		|	ВзаиморасчетыССотрудниками.Организация.*,
		|	ВзаиморасчетыССотрудниками.Сотрудник.*,
		|	ВзаиморасчетыССотрудниками.ФизическоеЛицо.*,
		|	ВзаиморасчетыССотрудниками.СтатьяФинансирования.*,
		|	ВзаиморасчетыССотрудниками.СтатьяРасходов.*,
		|	ВзаиморасчетыССотрудниками.Подразделение.*,
		|	(НЕОПРЕДЕЛЕНО) КАК Группа}
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	НАЧАЛОПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ) КАК МесяцНачисления,
		|	НачисленияИУдержания.Период КАК Период,
		|	НачисленияИУдержания.ФизическоеЛицо КАК ФизическоеЛицо,
		|	НачисленияИУдержания.СтатьяФинансирования КАК СтатьяФинансирования,
		|	НачисленияИУдержания.СтатьяРасходов КАК СтатьяРасходов,
		|	НачисленияИУдержания.Подразделение КАК Подразделение,
		|	НачисленияИУдержания.ГруппаНачисленияУдержанияВыплаты КАК Группа,
		|	НачисленияИУдержания.НачислениеУдержание КАК ВидРасчета,
		|	СУММА(НачисленияИУдержания.Сумма) КАК Сумма,
		|	НачисленияИУдержания.Организация КАК Организация,
		|	НачисленияИУдержания.Организация.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	НачисленияИУдержания.Сотрудник КАК Сотрудник,
		|	НачисленияИУдержания.ДатаНачала КАК ДатаНачала,
		|	НачисленияИУдержания.ДатаОкончания КАК ДатаОкончания,
		|	НачисленияИУдержания.Сотрудник.ГоловнойСотрудник КАК ГоловнойСотрудник,
		|	НачисленияИУдержания.ПериодДействия КАК ПериодДействия,
		|	НачисленияИУдержания.Регистратор КАК Регистратор,
		|	НачисленияИУдержания.ДокументОснование КАК ДокументОснование,
		|	НачисленияИУдержания.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	НачисленияИУдержания.Сторно КАК Сторно,
		|	ИСТИНА КАК НачислениеТекущегоПериода
		|ПОМЕСТИТЬ ВТНачисленияИУдержанияБезКадровыхДанных
		|ИЗ
		|	РегистрНакопления.НачисленияУдержанияПоСотрудникам КАК НачисленияИУдержания
		|ГДЕ
		|	НачисленияИУдержания.Период МЕЖДУ &НачалоПериода И &КонецПериода
		|	И НЕ НачисленияИУдержания.Регистратор В (&ИсключаемыеСсылки)
		|{ГДЕ
		|	НачисленияИУдержания.Сотрудник.*,
		|	НачисленияИУдержания.ФизическоеЛицо.*,
		|	НачисленияИУдержания.Организация.*,
		|	НачисленияИУдержания.Сотрудник.ГоловнойСотрудник.* КАК ГоловнойСотрудник}
		|
		|СГРУППИРОВАТЬ ПО
		|	НачисленияИУдержания.Период,
		|	НачисленияИУдержания.ФизическоеЛицо,
		|	НачисленияИУдержания.СтатьяФинансирования,
		|	НачисленияИУдержания.СтатьяРасходов,
		|	НачисленияИУдержания.Подразделение,
		|	НачисленияИУдержания.ГруппаНачисленияУдержанияВыплаты,
		|	НачисленияИУдержания.НачислениеУдержание,
		|	НачисленияИУдержания.Организация,
		|	НачисленияИУдержания.Сотрудник,
		|	НачисленияИУдержания.ДатаНачала,
		|	НачисленияИУдержания.ДатаОкончания,
		|	НачисленияИУдержания.Сотрудник.ГоловнойСотрудник,
		|	НачисленияИУдержания.ПериодДействия,
		|	НачисленияИУдержания.Регистратор,
		|	НАЧАЛОПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ),
		|	НачисленияИУдержания.ДокументОснование,
		|	НачисленияИУдержания.ИдентификаторСтроки,
		|	НачисленияИУдержания.Организация.ГоловнаяОрганизация,
		|	НачисленияИУдержания.Сторно
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НАЧАЛОПЕРИОДА(НачисленияИУдержания.ПериодДействия, МЕСЯЦ),
		|	НачисленияИУдержания.Период,
		|	НачисленияИУдержания.ФизическоеЛицо,
		|	НачисленияИУдержания.СтатьяФинансирования,
		|	НачисленияИУдержания.СтатьяРасходов,
		|	НачисленияИУдержания.Подразделение,
		|	НачисленияИУдержания.ГруппаНачисленияУдержанияВыплаты,
		|	НачисленияИУдержания.НачислениеУдержание,
		|	0,
		|	НачисленияИУдержания.Организация,
		|	НачисленияИУдержания.Организация.ГоловнаяОрганизация,
		|	НачисленияИУдержания.Сотрудник,
		|	НачисленияИУдержания.ДатаНачала,
		|	НачисленияИУдержания.ДатаОкончания,
		|	ВЫРАЗИТЬ(НачисленияИУдержания.Сотрудник КАК Справочник.Сотрудники).ГоловнойСотрудник,
		|	НачисленияИУдержания.ПериодДействия,
		|	НачисленияИУдержания.Регистратор,
		|	НачисленияИУдержания.ДокументОснование,
		|	НачисленияИУдержания.ИдентификаторСтроки,
		|	НачисленияИУдержания.Сторно,
		|	ЛОЖЬ
		|ИЗ
		|	РегистрНакопления.НачисленияУдержанияПоСотрудникам КАК НачисленияИУдержания
		|ГДЕ
		|	НачисленияИУдержания.ПериодДействия МЕЖДУ &НачалоПериода И &КонецПериода
		|	И НЕ НачисленияИУдержания.Регистратор В (&ИсключаемыеСсылки)
		|	И НачисленияИУдержания.ПериодДействия <> НАЧАЛОПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ)
		|{ГДЕ
		|	НачисленияИУдержания.Сотрудник.*,
		|	НачисленияИУдержания.ФизическоеЛицо.*,
		|	НачисленияИУдержания.Организация.*,
		|	НачисленияИУдержания.Сотрудник.ГоловнойСотрудник.* КАК ГоловнойСотрудник}
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	ОстаткиИОбороты.Организация КАК Организация,
		|	ОстаткиИОбороты.Сотрудник КАК Сотрудник,
		|	ОстаткиИОбороты.ФизическоеЛицо КАК ФизическоеЛицо,
		|	ОстаткиИОбороты.СтатьяФинансирования КАК СтатьяФинансирования,
		|	ОстаткиИОбороты.СтатьяРасходов КАК СтатьяРасходов,
		|	ОстаткиИОбороты.Подразделение КАК Подразделение,
		|	КОНЕЦПЕРИОДА(ОстаткиИОбороты.Период, МЕСЯЦ) КАК Период
		|ПОМЕСТИТЬ ВТВсеСотрудникиСПериодом
		|ИЗ
		|	ВТОстаткиИОборотыВзаиморасчетовССотрудниками КАК ОстаткиИОбороты
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ОстаткиИОбороты.Организация,
		|	ОстаткиИОбороты.Сотрудник,
		|	ОстаткиИОбороты.ФизическоеЛицо,
		|	ОстаткиИОбороты.СтатьяФинансирования,
		|	ОстаткиИОбороты.СтатьяРасходов,
		|	ОстаткиИОбороты.Подразделение,
		|	КОНЕЦПЕРИОДА(ОстаткиИОбороты.Период, МЕСЯЦ)
		|ИЗ
		|	ВТОстаткиИОборотыБухгалтерскихВзаиморасчетовССотрудниками КАК ОстаткиИОбороты
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НачисленияИУдержания.Организация,
		|	НачисленияИУдержания.Сотрудник,
		|	НачисленияИУдержания.ФизическоеЛицо,
		|	НачисленияИУдержания.СтатьяФинансирования,
		|	НачисленияИУдержания.СтатьяРасходов,
		|	НачисленияИУдержания.Подразделение,
		|	КОНЕЦПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ)
		|ИЗ
		|	ВТНачисленияИУдержанияБезКадровыхДанных КАК НачисленияИУдержания
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НачисленияИУдержания.Организация,
		|	НачисленияИУдержания.Сотрудник,
		|	НачисленияИУдержания.ФизическоеЛицо,
		|	НачисленияИУдержания.СтатьяФинансирования,
		|	НачисленияИУдержания.СтатьяРасходов,
		|	НачисленияИУдержания.Подразделение,
		|	НачисленияИУдержания.ДатаНачала
		|ИЗ
		|	ВТНачисленияИУдержанияБезКадровыхДанных КАК НачисленияИУдержания
		|ГДЕ
		|	НачисленияИУдержания.ДатаНачала <> ДАТАВРЕМЯ(1, 1, 1)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ОстаткиИОбороты.Организация КАК Организация,
		|	ОстаткиИОбороты.Сотрудник КАК Сотрудник,
		|	ОстаткиИОбороты.ФизическоеЛицо КАК ФизическоеЛицо,
		|	ОстаткиИОбороты.Подразделение КАК Подразделение,
		|	ОстаткиИОбороты.СтатьяФинансирования КАК СтатьяФинансирования,
		|	ОстаткиИОбороты.СтатьяРасходов КАК СтатьяРасходов,
		|	Месяцы.Период КАК Месяц
		|ПОМЕСТИТЬ ВТСотрудникиМесяцы
		|ИЗ
		|	ВТВсеСотрудникиСПериодом КАК ОстаткиИОбороты
		|		ЛЕВОЕ СОЕДИНЕНИЕ Представления_Периоды КАК Месяцы
		|		ПО (ИСТИНА)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ОстаткиИОбороты.Организация КАК Организация,
		|	ОстаткиИОбороты.Сотрудник КАК Сотрудник,
		|	ОстаткиИОбороты.ФизическоеЛицо КАК ФизическоеЛицо,
		|	ОстаткиИОбороты.Подразделение КАК Подразделение,
		|	ОстаткиИОбороты.СтатьяФинансирования КАК СтатьяФинансирования,
		|	ОстаткиИОбороты.СтатьяРасходов КАК СтатьяРасходов,
		|	ОстаткиИОбороты.Период КАК Период
		|ПОМЕСТИТЬ ВТВсеПериодомКадровыхДанных
		|ИЗ
		|	ВТВсеСотрудникиСПериодом КАК ОстаткиИОбороты
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ОстаткиИОбороты.Организация,
		|	ОстаткиИОбороты.Сотрудник,
		|	ОстаткиИОбороты.ФизическоеЛицо,
		|	ОстаткиИОбороты.Подразделение,
		|	ОстаткиИОбороты.СтатьяФинансирования,
		|	ОстаткиИОбороты.СтатьяРасходов,
		|	ОстаткиИОбороты.Месяц
		|ИЗ
		|	ВТСотрудникиМесяцы КАК ОстаткиИОбороты
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ОстаткиИОбороты.Организация,
		|	ОстаткиИОбороты.Сотрудник,
		|	ОстаткиИОбороты.ФизическоеЛицо,
		|	ОстаткиИОбороты.Подразделение,
		|	ОстаткиИОбороты.СтатьяФинансирования,
		|	ОстаткиИОбороты.СтатьяРасходов,
		|	КОНЕЦПЕРИОДА(ОстаткиИОбороты.Месяц, МЕСЯЦ)
		|ИЗ
		|	ВТСотрудникиМесяцы КАК ОстаткиИОбороты
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	ДАТАВРЕМЯ(1, 1, 1) КАК Период,
		|	ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка) КАК ФизическоеЛицо,
		|	ЗНАЧЕНИЕ(Справочник.Сотрудники.ПустаяСсылка) КАК Сотрудник,
		|	ЗНАЧЕНИЕ(Справочник.Сотрудники.ПустаяСсылка) КАК ГоловнойСотрудник,
		|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК Организация,
		|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК ГоловнаяОрганизация,
		|	ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка) КАК Подразделение,
		|	ЗНАЧЕНИЕ(Справочник.Должности.ПустаяСсылка) КАК Должность,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыЗанятости.ПустаяСсылка) КАК ВидЗанятости,
		|	"""" КАК ФИОПолные,
		|	"""" КАК ФамилияИО,
		|	"""" КАК Фамилия,
		|	"""" КАК Имя,
		|	"""" КАК Отчество,
		|	0 КАК ТарифнаяСтавка,
		|	0 КАК ТекущаяТарифнаяСтавка,
		|	ДАТАВРЕМЯ(1, 1, 1) КАК ДатаПриема,
		|	ДАТАВРЕМЯ(1, 1, 1) КАК ДатаУвольнения,
		|	0 КАК ПриоритетРабочегоМеста
		|ПОМЕСТИТЬ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний
		|ГДЕ
		|	""ТолькоРазрешенные"" = ИСТИНА
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ДАТАВРЕМЯ(1, 1, 1) КАК Период,
		|	ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка) КАК ФизическоеЛицо,
		|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК ГоловнаяОрганизация,
		|	ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка) КАК ПодразделениеСортировки,
		|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК ОрганизацияСортировки
		|ПОМЕСТИТЬ Представления_ПодразделенияСортировкиСотрудников
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СотрудникиМесяцы.Организация КАК Организация,
		|	СотрудникиМесяцы.Сотрудник КАК Сотрудник,
		|	СотрудникиМесяцы.ФизическоеЛицо КАК ФизическоеЛицо,
		|	СотрудникиМесяцы.СтатьяФинансирования КАК СтатьяФинансирования,
		|	СотрудникиМесяцы.СтатьяРасходов КАК СтатьяРасходов,
		|	СотрудникиМесяцы.Подразделение КАК Подразделение,
		|	СотрудникиМесяцы.Месяц КАК Месяц,
		|	МАКСИМУМ(ОстаткиИОбороты.Период) КАК ПоследнийМесяцОстатков
		|ПОМЕСТИТЬ ВТСотрудникиМесяцыОстатков
		|ИЗ
		|	ВТСотрудникиМесяцы КАК СотрудникиМесяцы
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОстаткиИОборотыВзаиморасчетовССотрудниками КАК ОстаткиИОбороты
		|		ПО СотрудникиМесяцы.Организация = ОстаткиИОбороты.Организация
		|			И СотрудникиМесяцы.Сотрудник = ОстаткиИОбороты.Сотрудник
		|			И СотрудникиМесяцы.ФизическоеЛицо = ОстаткиИОбороты.ФизическоеЛицо
		|			И СотрудникиМесяцы.Подразделение = ОстаткиИОбороты.Подразделение
		|			И СотрудникиМесяцы.СтатьяФинансирования = ОстаткиИОбороты.СтатьяФинансирования
		|			И СотрудникиМесяцы.СтатьяРасходов = ОстаткиИОбороты.СтатьяРасходов
		|			И СотрудникиМесяцы.Месяц >= ОстаткиИОбороты.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	СотрудникиМесяцы.Организация,
		|	СотрудникиМесяцы.Сотрудник,
		|	СотрудникиМесяцы.ФизическоеЛицо,
		|	СотрудникиМесяцы.СтатьяФинансирования,
		|	СотрудникиМесяцы.СтатьяРасходов,
		|	СотрудникиМесяцы.Подразделение,
		|	СотрудникиМесяцы.Месяц
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СотрудникиМесяцыОстатков.Организация КАК Организация,
		|	СотрудникиМесяцыОстатков.Сотрудник КАК Сотрудник,
		|	СотрудникиМесяцыОстатков.ФизическоеЛицо КАК ФизическоеЛицо,
		|	СотрудникиМесяцыОстатков.СтатьяФинансирования КАК СтатьяФинансирования,
		|	СотрудникиМесяцыОстатков.СтатьяРасходов КАК СтатьяРасходов,
		|	СотрудникиМесяцыОстатков.Подразделение КАК Подразделение,
		|	ЕСТЬNULL(ОстаткиИОбороты.НачальныйОстаток, ОстаткиИОборотыПоследние.КонечныйОстаток) КАК НачальныйОстаток,
		|	ЕСТЬNULL(ОстаткиИОбороты.КонечныйОстаток, ОстаткиИОборотыПоследние.КонечныйОстаток) КАК КонечныйОстаток,
		|	КОНЕЦПЕРИОДА(СотрудникиМесяцыОстатков.Месяц, МЕСЯЦ) КАК Период
		|ПОМЕСТИТЬ ВТСальдоВсеСотрудникиПериоды
		|ИЗ
		|	ВТСотрудникиМесяцыОстатков КАК СотрудникиМесяцыОстатков
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОстаткиИОборотыВзаиморасчетовССотрудниками КАК ОстаткиИОбороты
		|		ПО СотрудникиМесяцыОстатков.Организация = ОстаткиИОбороты.Организация
		|			И СотрудникиМесяцыОстатков.Сотрудник = ОстаткиИОбороты.Сотрудник
		|			И СотрудникиМесяцыОстатков.ФизическоеЛицо = ОстаткиИОбороты.ФизическоеЛицо
		|			И СотрудникиМесяцыОстатков.Подразделение = ОстаткиИОбороты.Подразделение
		|			И СотрудникиМесяцыОстатков.СтатьяФинансирования = ОстаткиИОбороты.СтатьяФинансирования
		|			И СотрудникиМесяцыОстатков.СтатьяРасходов = ОстаткиИОбороты.СтатьяРасходов
		|			И СотрудникиМесяцыОстатков.Месяц = ОстаткиИОбороты.Период
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОстаткиИОборотыВзаиморасчетовССотрудниками КАК ОстаткиИОборотыПоследние
		|		ПО СотрудникиМесяцыОстатков.Организация = ОстаткиИОборотыПоследние.Организация
		|			И СотрудникиМесяцыОстатков.Сотрудник = ОстаткиИОборотыПоследние.Сотрудник
		|			И СотрудникиМесяцыОстатков.ФизическоеЛицо = ОстаткиИОборотыПоследние.ФизическоеЛицо
		|			И СотрудникиМесяцыОстатков.Подразделение = ОстаткиИОборотыПоследние.Подразделение
		|			И СотрудникиМесяцыОстатков.СтатьяФинансирования = ОстаткиИОборотыПоследние.СтатьяФинансирования
		|			И СотрудникиМесяцыОстатков.СтатьяРасходов = ОстаткиИОборотыПоследние.СтатьяРасходов
		|			И СотрудникиМесяцыОстатков.ПоследнийМесяцОстатков = ОстаткиИОборотыПоследние.Период
		|ГДЕ
		|	(НЕ ЕСТЬNULL(ОстаткиИОборотыПоследние.КонечныйОстаток, ОстаткиИОбороты.НачальныйОстаток) ЕСТЬ NULL
		|			ИЛИ НЕ ОстаткиИОбороты.КонечныйОстаток ЕСТЬ NULL)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	МИНИМУМ(НАЧАЛОПЕРИОДА(СальдоПоРасчетамССотрудниками.Период, МЕСЯЦ)) КАК ПервыйМесяц,
		|	МАКСИМУМ(НАЧАЛОПЕРИОДА(СальдоПоРасчетамССотрудниками.Период, МЕСЯЦ)) КАК ПоследнийМесяц,
		|	СальдоПоРасчетамССотрудниками.Организация КАК Организация,
		|	СальдоПоРасчетамССотрудниками.Сотрудник КАК Сотрудник,
		|	СальдоПоРасчетамССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо,
		|	СальдоПоРасчетамССотрудниками.Подразделение КАК Подразделение,
		|	СальдоПоРасчетамССотрудниками.СтатьяФинансирования КАК СтатьяФинансирования,
		|	СальдоПоРасчетамССотрудниками.СтатьяРасходов КАК СтатьяРасходов
		|ПОМЕСТИТЬ ВТПоследниеПервыеМесяцыСальдо
		|ИЗ
		|	ВТСальдоВсеСотрудникиПериоды КАК СальдоПоРасчетамССотрудниками
		|
		|СГРУППИРОВАТЬ ПО
		|	СальдоПоРасчетамССотрудниками.Организация,
		|	СальдоПоРасчетамССотрудниками.Сотрудник,
		|	СальдоПоРасчетамССотрудниками.ФизическоеЛицо,
		|	СальдоПоРасчетамССотрудниками.Подразделение,
		|	СальдоПоРасчетамССотрудниками.СтатьяФинансирования,
		|	СальдоПоРасчетамССотрудниками.СтатьяРасходов
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ПодразделенияСортировкиСотрудников.ОрганизацияСортировки КАК ОрганизацияСортировки,
		|	ПодразделенияСортировкиСотрудников.ПодразделениеСортировки КАК ПодразделениеСортировки,
		|	КадровыеДанныеСотрудников.ПриоритетРабочегоМеста КАК ПриоритетРабочегоМеста,
		|	ВзаиморасчетыССотрудниками.Сотрудник КАК Сотрудник,
		|	ВЫРАЗИТЬ(ВзаиморасчетыССотрудниками.Сотрудник КАК Справочник.Сотрудники).ГоловнойСотрудник КАК ГоловнойСотрудник,
		|	КадровыеДанныеГоловныхСотрудников.Должность КАК ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Организация КАК ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Подразделение КАК ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.ВидЗанятости КАК ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ВзаиморасчетыССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо,
		|	ВзаиморасчетыССотрудниками.СтатьяФинансирования КАК СтатьяФинансирования,
		|	ВзаиморасчетыССотрудниками.СтатьяРасходов КАК СтатьяРасходов,
		|	ВзаиморасчетыССотрудниками.Организация КАК Организация,
		|	ВзаиморасчетыССотрудниками.Подразделение КАК Подразделение,
		|	ВзаиморасчетыССотрудниками.НачальныйОстаток КАК НачальныйОстаток,
		|	ВзаиморасчетыССотрудниками.КонечныйОстаток КАК КонечныйОстаток,
		|	НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) КАК Период,
		|	КадровыеДанныеГоловныхСотрудников.Подразделение КАК ПодразделениеНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.ВидЗанятости КАК ВидЗанятостиНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.ФИОПолные КАК ФИОПолные,
		|	КадровыеДанныеГоловныхСотрудников.ФамилияИО КАК ФамилияИО,
		|	КадровыеДанныеГоловныхСотрудников.Фамилия КАК Фамилия,
		|	КадровыеДанныеГоловныхСотрудников.Имя КАК Имя,
		|	КадровыеДанныеГоловныхСотрудников.Отчество КАК Отчество,
		|	КадровыеДанныеСотрудников.Должность КАК Должность,
		|	КадровыеДанныеГоловныхСотрудников.Должность КАК ДолжностьНаКонецПериода,
		|	ВЫБОР
		|		КОГДА КадровыеДанныеГоловныхСотрудников.ДатаУвольнения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И КадровыеДанныеГоловныхСотрудников.ДатаУвольнения <= КадровыеДанныеГоловныхСотрудников.Период
		|			ТОГДА КадровыеДанныеГоловныхСотрудников.ТекущаяТарифнаяСтавка
		|		ИНАЧЕ КадровыеДанныеГоловныхСотрудников.ТарифнаяСтавка
		|	КОНЕЦ КАК ТарифнаяСтавка,
		|	КадровыеДанныеСотрудников.ВидЗанятости КАК ВидЗанятости,
		|	КадровыеДанныеСотрудников.ДатаПриема КАК ДатаПриема,
		|	КадровыеДанныеСотрудников.ДатаУвольнения КАК ДатаУвольнения,
		|	ПоследниеПервыеМесяцыСальдо.ПервыйМесяц КАК ПервыйМесяц,
		|	ПоследниеПервыеМесяцыСальдо.ПоследнийМесяц КАК ПоследнийМесяц
		|ПОМЕСТИТЬ ВТСальдоПоРасчетамССотрудниками
		|ИЗ
		|	ВТСальдоВсеСотрудникиПериоды КАК ВзаиморасчетыССотрудниками
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПоследниеПервыеМесяцыСальдо КАК ПоследниеПервыеМесяцыСальдо
		|		ПО ВзаиморасчетыССотрудниками.Организация = ПоследниеПервыеМесяцыСальдо.Организация
		|			И ВзаиморасчетыССотрудниками.Сотрудник = ПоследниеПервыеМесяцыСальдо.Сотрудник
		|			И ВзаиморасчетыССотрудниками.ФизическоеЛицо = ПоследниеПервыеМесяцыСальдо.ФизическоеЛицо
		|			И ВзаиморасчетыССотрудниками.Подразделение = ПоследниеПервыеМесяцыСальдо.Подразделение
		|			И ВзаиморасчетыССотрудниками.СтатьяФинансирования = ПоследниеПервыеМесяцыСальдо.СтатьяФинансирования
		|			И ВзаиморасчетыССотрудниками.СтатьяРасходов = ПоследниеПервыеМесяцыСальдо.СтатьяРасходов
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеГоловныхСотрудников
		|		ПО ВзаиморасчетыССотрудниками.Сотрудник = КадровыеДанныеГоловныхСотрудников.Сотрудник
		|			И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = КадровыеДанныеГоловныхСотрудников.Период)}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудников
		|		ПО ВзаиморасчетыССотрудниками.Сотрудник = КадровыеДанныеСотрудников.Сотрудник
		|			И ВзаиморасчетыССотрудниками.Период = КадровыеДанныеСотрудников.Период}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_ПодразделенияСортировкиСотрудников КАК ПодразделенияСортировкиСотрудников
		|		ПО ВзаиморасчетыССотрудниками.ФизическоеЛицо = ПодразделенияСортировкиСотрудников.ФизическоеЛицо
		|			И ВзаиморасчетыССотрудниками.Организация.ГоловнаяОрганизация = ПодразделенияСортировкиСотрудников.ГоловнаяОрганизация
		|			И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = ПодразделенияСортировкиСотрудников.Период)}
		|ГДЕ
		|	ВЫБОР
		|			КОГДА ВзаиморасчетыССотрудниками.НачальныйОстаток <> 0
		|				ТОГДА ИСТИНА
		|			КОГДА ВзаиморасчетыССотрудниками.КонечныйОстаток <> 0
		|				ТОГДА ИСТИНА
		|			КОГДА КадровыеДанныеГоловныхСотрудников.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
		|				ТОГДА ИСТИНА
		|			КОГДА КадровыеДанныеГоловныхСотрудников.ДатаУвольнения >= НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ)
		|				ТОГДА ИСТИНА
		|			ИНАЧЕ ЛОЖЬ
		|		КОНЕЦ
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ПодразделенияСортировкиСотрудников.ОрганизацияСортировки КАК ОрганизацияСортировки,
		|	ПодразделенияСортировкиСотрудников.ПодразделениеСортировки КАК ПодразделениеСортировки,
		|	КадровыеДанныеСотрудников.ПриоритетРабочегоМеста КАК ПриоритетРабочегоМеста,
		|	НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) КАК МесяцНачисления,
		|	ВзаиморасчетыССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо,
		|	ВзаиморасчетыССотрудниками.СтатьяФинансирования КАК СтатьяФинансирования,
		|	ВзаиморасчетыССотрудниками.СтатьяРасходов КАК СтатьяРасходов,
		|	ВзаиморасчетыССотрудниками.Подразделение КАК Подразделение,
		|	ВзаиморасчетыССотрудниками.ГруппаНачисленияУдержанияВыплаты КАК Группа,
		|	ВзаиморасчетыССотрудниками.ВидВзаиморасчетов КАК ВидРасчета,
		|	ВзаиморасчетыССотрудниками.СуммаВзаиморасчетов КАК Сумма,
		|	ВЫБОР
		|		КОГДА НЕ ВзаиморасчетыССотрудниками.Подразделение.Владелец ЕСТЬ NULL
		|			ТОГДА ВзаиморасчетыССотрудниками.Подразделение.Владелец
		|		КОГДА КадровыеДанныеСотрудников.Организация <> ЗНАЧЕНИЕ(СПРАВОЧНИК.Организации.ПустаяСсылка)
		|			ТОГДА КадровыеДанныеСотрудников.Организация
		|		ИНАЧЕ ВзаиморасчетыССотрудниками.Организация
		|	КОНЕЦ КАК Организация,
		|	ВзаиморасчетыССотрудниками.Сотрудник КАК Сотрудник,
		|	ВЫРАЗИТЬ(ВзаиморасчетыССотрудниками.Сотрудник КАК Справочник.Сотрудники).ГоловнойСотрудник КАК ГоловнойСотрудник,
		|	КадровыеДанныеГоловныхСотрудников.ФИОПолные КАК ФИОПолные,
		|	КадровыеДанныеГоловныхСотрудников.ФамилияИО КАК ФамилияИО,
		|	КадровыеДанныеГоловныхСотрудников.Фамилия КАК Фамилия,
		|	КадровыеДанныеГоловныхСотрудников.Имя КАК Имя,
		|	КадровыеДанныеГоловныхСотрудников.Отчество КАК Отчество,
		|	КадровыеДанныеГоловныхСотрудников.Должность КАК ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Организация КАК ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Подразделение КАК ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.ВидЗанятости КАК ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) КАК ПериодДействия,
		|	ВзаиморасчетыССотрудниками.Регистратор КАК Регистратор,
		|	КадровыеДанныеСотрудников.Подразделение КАК ПодразделениеНаКонецПериода,
		|	КадровыеДанныеСотрудников.ВидЗанятости КАК ВидЗанятостиНаКонецПериода,
		|	КадровыеДанныеСотрудников.Должность КАК ДолжностьНаКонецПериода,
		|	ВЫБОР
		|		КОГДА КадровыеДанныеСотрудников.ДатаУвольнения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И КадровыеДанныеСотрудников.ДатаУвольнения <= КадровыеДанныеСотрудников.Период
		|			ТОГДА КадровыеДанныеСотрудников.ТекущаяТарифнаяСтавка
		|		ИНАЧЕ КадровыеДанныеСотрудников.ТарифнаяСтавка
		|	КОНЕЦ КАК ТарифнаяСтавкаНаКонецПериода,
		|	КадровыеДанныеСотрудников.ВидЗанятости КАК ВидЗанятости,
		|	КадровыеДанныеСотрудников.Должность КАК Должность,
		|	КадровыеДанныеСотрудников.ТарифнаяСтавка КАК ТарифнаяСтавка,
		|	КадровыеДанныеГоловныхСотрудников.ДатаПриема КАК ДатаПриема,
		|	КадровыеДанныеГоловныхСотрудников.ДатаУвольнения КАК ДатаУвольнения
		|ПОМЕСТИТЬ ВТДвиженияВзаиморасчетов
		|ИЗ
		|	РегистрНакопления.ВзаиморасчетыССотрудниками КАК ВзаиморасчетыССотрудниками
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудников
		|		ПО ВзаиморасчетыССотрудниками.Сотрудник = КадровыеДанныеСотрудников.Сотрудник
		|			И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = КадровыеДанныеСотрудников.Период)}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеГоловныхСотрудников
		|		ПО (ВЫРАЗИТЬ(ВзаиморасчетыССотрудниками.Сотрудник КАК Справочник.Сотрудники).ГоловнойСотрудник = КадровыеДанныеГоловныхСотрудников.Сотрудник)
		|			И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = КадровыеДанныеГоловныхСотрудников.Период)}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_ПодразделенияСортировкиСотрудников КАК ПодразделенияСортировкиСотрудников
		|		ПО ВзаиморасчетыССотрудниками.ФизическоеЛицо = ПодразделенияСортировкиСотрудников.ФизическоеЛицо
		|			И ВзаиморасчетыССотрудниками.Организация.ГоловнаяОрганизация = ПодразделенияСортировкиСотрудников.ГоловнаяОрганизация
		|			И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = ПодразделенияСортировкиСотрудников.Период)}
		|ГДЕ
		|	ВзаиморасчетыССотрудниками.Период МЕЖДУ &НачалоПериода И &КонецПериода
		|	И ВзаиморасчетыССотрудниками.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|	И ВзаиморасчетыССотрудниками.ВидВзаиморасчетов <> ЗНАЧЕНИЕ(Перечисление.ВидыВзаиморасчетовССотрудниками.ПустаяСсылка)
		|	И НЕ ВзаиморасчетыССотрудниками.Регистратор В (&ИсключаемыеСсылки)
		|{ГДЕ
		|	ВзаиморасчетыССотрудниками.Сотрудник.*,
		|	ВзаиморасчетыССотрудниками.ФизическоеЛицо.*,
		|	ВзаиморасчетыССотрудниками.Организация.*,
		|	ВзаиморасчетыССотрудниками.Сотрудник.ГоловнойСотрудник.* КАК ГоловнойСотрудник}
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СотрудникиМесяцы.Организация КАК Организация,
		|	СотрудникиМесяцы.Сотрудник КАК Сотрудник,
		|	СотрудникиМесяцы.ФизическоеЛицо КАК ФизическоеЛицо,
		|	СотрудникиМесяцы.СтатьяФинансирования КАК СтатьяФинансирования,
		|	СотрудникиМесяцы.СтатьяРасходов КАК СтатьяРасходов,
		|	СотрудникиМесяцы.Подразделение КАК Подразделение,
		|	СотрудникиМесяцы.Месяц КАК Месяц,
		|	МАКСИМУМ(БухгалтерскиеОстаткиИОбороты.Период) КАК ПоследнийМесяцОстатков
		|ПОМЕСТИТЬ ВТСотрудникиМесяцыБухгалтерскихОстатков
		|ИЗ
		|	ВТСотрудникиМесяцы КАК СотрудникиМесяцы
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОстаткиИОборотыБухгалтерскихВзаиморасчетовССотрудниками КАК БухгалтерскиеОстаткиИОбороты
		|		ПО СотрудникиМесяцы.Организация = БухгалтерскиеОстаткиИОбороты.Организация
		|			И СотрудникиМесяцы.Сотрудник = БухгалтерскиеОстаткиИОбороты.Сотрудник
		|			И СотрудникиМесяцы.ФизическоеЛицо = БухгалтерскиеОстаткиИОбороты.ФизическоеЛицо
		|			И СотрудникиМесяцы.Подразделение = БухгалтерскиеОстаткиИОбороты.Подразделение
		|			И СотрудникиМесяцы.СтатьяФинансирования = БухгалтерскиеОстаткиИОбороты.СтатьяФинансирования
		|			И СотрудникиМесяцы.СтатьяРасходов = БухгалтерскиеОстаткиИОбороты.СтатьяРасходов
		|			И СотрудникиМесяцы.Месяц >= БухгалтерскиеОстаткиИОбороты.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	СотрудникиМесяцы.Организация,
		|	СотрудникиМесяцы.Сотрудник,
		|	СотрудникиМесяцы.ФизическоеЛицо,
		|	СотрудникиМесяцы.СтатьяФинансирования,
		|	СотрудникиМесяцы.СтатьяРасходов,
		|	СотрудникиМесяцы.Подразделение,
		|	СотрудникиМесяцы.Месяц
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СотрудникиМесяцыБухгалтерскихОстатков.Организация КАК Организация,
		|	СотрудникиМесяцыБухгалтерскихОстатков.Сотрудник КАК Сотрудник,
		|	СотрудникиМесяцыБухгалтерскихОстатков.ФизическоеЛицо КАК ФизическоеЛицо,
		|	СотрудникиМесяцыБухгалтерскихОстатков.СтатьяФинансирования КАК СтатьяФинансирования,
		|	СотрудникиМесяцыБухгалтерскихОстатков.СтатьяРасходов КАК СтатьяРасходов,
		|	СотрудникиМесяцыБухгалтерскихОстатков.Подразделение КАК Подразделение,
		|	ЕСТЬNULL(БухгалтерскиеОстаткиИОбороты.НачальныйОстаток, БухгалтерскиеОстаткиИОборотыПоследние.КонечныйОстаток) КАК НачальныйОстаток,
		|	ЕСТЬNULL(БухгалтерскиеОстаткиИОбороты.КонечныйОстаток, БухгалтерскиеОстаткиИОборотыПоследние.КонечныйОстаток) КАК КонечныйОстаток,
		|	КОНЕЦПЕРИОДА(СотрудникиМесяцыБухгалтерскихОстатков.Месяц, МЕСЯЦ) КАК Период
		|ПОМЕСТИТЬ ВТБухгалтерскоеСальдоВсеСотрудникиПериоды
		|ИЗ
		|	ВТСотрудникиМесяцыБухгалтерскихОстатков КАК СотрудникиМесяцыБухгалтерскихОстатков
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОстаткиИОборотыБухгалтерскихВзаиморасчетовССотрудниками КАК БухгалтерскиеОстаткиИОбороты
		|		ПО СотрудникиМесяцыБухгалтерскихОстатков.Организация = БухгалтерскиеОстаткиИОбороты.Организация
		|			И СотрудникиМесяцыБухгалтерскихОстатков.Сотрудник = БухгалтерскиеОстаткиИОбороты.Сотрудник
		|			И СотрудникиМесяцыБухгалтерскихОстатков.ФизическоеЛицо = БухгалтерскиеОстаткиИОбороты.ФизическоеЛицо
		|			И СотрудникиМесяцыБухгалтерскихОстатков.Подразделение = БухгалтерскиеОстаткиИОбороты.Подразделение
		|			И СотрудникиМесяцыБухгалтерскихОстатков.СтатьяФинансирования = БухгалтерскиеОстаткиИОбороты.СтатьяФинансирования
		|			И СотрудникиМесяцыБухгалтерскихОстатков.СтатьяРасходов = БухгалтерскиеОстаткиИОбороты.СтатьяРасходов
		|			И СотрудникиМесяцыБухгалтерскихОстатков.Месяц = БухгалтерскиеОстаткиИОбороты.Период
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТОстаткиИОборотыБухгалтерскихВзаиморасчетовССотрудниками КАК БухгалтерскиеОстаткиИОборотыПоследние
		|		ПО СотрудникиМесяцыБухгалтерскихОстатков.Организация = БухгалтерскиеОстаткиИОборотыПоследние.Организация
		|			И СотрудникиМесяцыБухгалтерскихОстатков.Сотрудник = БухгалтерскиеОстаткиИОборотыПоследние.Сотрудник
		|			И СотрудникиМесяцыБухгалтерскихОстатков.ФизическоеЛицо = БухгалтерскиеОстаткиИОборотыПоследние.ФизическоеЛицо
		|			И СотрудникиМесяцыБухгалтерскихОстатков.Подразделение = БухгалтерскиеОстаткиИОборотыПоследние.Подразделение
		|			И СотрудникиМесяцыБухгалтерскихОстатков.СтатьяФинансирования = БухгалтерскиеОстаткиИОборотыПоследние.СтатьяФинансирования
		|			И СотрудникиМесяцыБухгалтерскихОстатков.СтатьяРасходов = БухгалтерскиеОстаткиИОборотыПоследние.СтатьяРасходов
		|			И СотрудникиМесяцыБухгалтерскихОстатков.ПоследнийМесяцОстатков = БухгалтерскиеОстаткиИОборотыПоследние.Период
		|ГДЕ
		|	(НЕ ЕСТЬNULL(БухгалтерскиеОстаткиИОборотыПоследние.КонечныйОстаток, БухгалтерскиеОстаткиИОбороты.НачальныйОстаток) ЕСТЬ NULL
		|			ИЛИ НЕ БухгалтерскиеОстаткиИОбороты.КонечныйОстаток ЕСТЬ NULL)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	МИНИМУМ(НАЧАЛОПЕРИОДА(БухгалтерскоеСальдоПоРасчетамССотрудниками.Период, МЕСЯЦ)) КАК ПервыйМесяц,
		|	МАКСИМУМ(НАЧАЛОПЕРИОДА(БухгалтерскоеСальдоПоРасчетамССотрудниками.Период, МЕСЯЦ)) КАК ПоследнийМесяц,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.Организация КАК Организация,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.Сотрудник КАК Сотрудник,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.Подразделение КАК Подразделение,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.СтатьяФинансирования КАК СтатьяФинансирования,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.СтатьяРасходов КАК СтатьяРасходов
		|ПОМЕСТИТЬ ВТПоследниеПервыеМесяцыБухгалтерскогоСальдо
		|ИЗ
		|	ВТБухгалтерскоеСальдоВсеСотрудникиПериоды КАК БухгалтерскоеСальдоПоРасчетамССотрудниками
		|
		|СГРУППИРОВАТЬ ПО
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.Организация,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.Сотрудник,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.ФизическоеЛицо,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.Подразделение,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.СтатьяФинансирования,
		|	БухгалтерскоеСальдоПоРасчетамССотрудниками.СтатьяРасходов
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ПодразделенияСортировкиСотрудников.ОрганизацияСортировки КАК ОрганизацияСортировки,
		|	ПодразделенияСортировкиСотрудников.ПодразделениеСортировки КАК ПодразделениеСортировки,
		|	КадровыеДанныеСотрудников.ПриоритетРабочегоМеста КАК ПриоритетРабочегоМеста,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Сотрудник КАК Сотрудник,
		|	ВЫРАЗИТЬ(БухгалтерскиеВзаиморасчетыССотрудниками.Сотрудник КАК Справочник.Сотрудники).ГоловнойСотрудник КАК ГоловнойСотрудник,
		|	КадровыеДанныеГоловныхСотрудников.Должность КАК ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Организация КАК ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Подразделение КАК ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.ВидЗанятости КАК ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.СтатьяФинансирования КАК СтатьяФинансирования,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.СтатьяРасходов КАК СтатьяРасходов,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Организация КАК Организация,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.Подразделение КАК Подразделение,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.НачальныйОстаток КАК НачальныйОстаток,
		|	БухгалтерскиеВзаиморасчетыССотрудниками.КонечныйОстаток КАК КонечныйОстаток,
		|	НАЧАЛОПЕРИОДА(БухгалтерскиеВзаиморасчетыССотрудниками.Период, МЕСЯЦ) КАК Период,
		|	КадровыеДанныеГоловныхСотрудников.Подразделение КАК ПодразделениеНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.ВидЗанятости КАК ВидЗанятостиНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.ФИОПолные КАК ФИОПолные,
		|	КадровыеДанныеГоловныхСотрудников.ФамилияИО КАК ФамилияИО,
		|	КадровыеДанныеГоловныхСотрудников.Фамилия КАК Фамилия,
		|	КадровыеДанныеГоловныхСотрудников.Имя КАК Имя,
		|	КадровыеДанныеГоловныхСотрудников.Отчество КАК Отчество,
		|	КадровыеДанныеСотрудников.Должность КАК Должность,
		|	КадровыеДанныеГоловныхСотрудников.Должность КАК ДолжностьНаКонецПериода,
		|	ВЫБОР
		|		КОГДА КадровыеДанныеГоловныхСотрудников.ДатаУвольнения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И КадровыеДанныеГоловныхСотрудников.ДатаУвольнения <= КадровыеДанныеГоловныхСотрудников.Период
		|			ТОГДА КадровыеДанныеГоловныхСотрудников.ТекущаяТарифнаяСтавка
		|		ИНАЧЕ КадровыеДанныеГоловныхСотрудников.ТарифнаяСтавка
		|	КОНЕЦ КАК ТарифнаяСтавка,
		|	КадровыеДанныеСотрудников.ВидЗанятости КАК ВидЗанятости,
		|	КадровыеДанныеСотрудников.ДатаПриема КАК ДатаПриема,
		|	КадровыеДанныеСотрудников.ДатаУвольнения КАК ДатаУвольнения,
		|	ПоследниеПервыеМесяцыСальдо.ПервыйМесяц КАК ПервыйМесяц,
		|	ПоследниеПервыеМесяцыСальдо.ПоследнийМесяц КАК ПоследнийМесяц
		|ПОМЕСТИТЬ ВТБухгалтерскоеСальдоПоРасчетамССотрудниками
		|ИЗ
		|	ВТБухгалтерскоеСальдоВсеСотрудникиПериоды КАК БухгалтерскиеВзаиморасчетыССотрудниками
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТПоследниеПервыеМесяцыБухгалтерскогоСальдо КАК ПоследниеПервыеМесяцыСальдо
		|		ПО БухгалтерскиеВзаиморасчетыССотрудниками.Организация = ПоследниеПервыеМесяцыСальдо.Организация
		|			И БухгалтерскиеВзаиморасчетыССотрудниками.Сотрудник = ПоследниеПервыеМесяцыСальдо.Сотрудник
		|			И БухгалтерскиеВзаиморасчетыССотрудниками.ФизическоеЛицо = ПоследниеПервыеМесяцыСальдо.ФизическоеЛицо
		|			И БухгалтерскиеВзаиморасчетыССотрудниками.Подразделение = ПоследниеПервыеМесяцыСальдо.Подразделение
		|			И БухгалтерскиеВзаиморасчетыССотрудниками.СтатьяФинансирования = ПоследниеПервыеМесяцыСальдо.СтатьяФинансирования
		|			И БухгалтерскиеВзаиморасчетыССотрудниками.СтатьяРасходов = ПоследниеПервыеМесяцыСальдо.СтатьяРасходов
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеГоловныхСотрудников
		|		ПО БухгалтерскиеВзаиморасчетыССотрудниками.Сотрудник = КадровыеДанныеГоловныхСотрудников.Сотрудник
		|			И (КОНЕЦПЕРИОДА(БухгалтерскиеВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = КадровыеДанныеГоловныхСотрудников.Период)}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудников
		|		ПО БухгалтерскиеВзаиморасчетыССотрудниками.Сотрудник = КадровыеДанныеСотрудников.Сотрудник
		|			И БухгалтерскиеВзаиморасчетыССотрудниками.Период = КадровыеДанныеСотрудников.Период}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_ПодразделенияСортировкиСотрудников КАК ПодразделенияСортировкиСотрудников
		|		ПО БухгалтерскиеВзаиморасчетыССотрудниками.ФизическоеЛицо = ПодразделенияСортировкиСотрудников.ФизическоеЛицо
		|			И БухгалтерскиеВзаиморасчетыССотрудниками.Организация.ГоловнаяОрганизация = ПодразделенияСортировкиСотрудников.ГоловнаяОрганизация
		|			И (КОНЕЦПЕРИОДА(БухгалтерскиеВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = ПодразделенияСортировкиСотрудников.Период)}
		|ГДЕ
		|	ВЫБОР
		|			КОГДА БухгалтерскиеВзаиморасчетыССотрудниками.НачальныйОстаток <> 0
		|				ТОГДА ИСТИНА
		|			КОГДА БухгалтерскиеВзаиморасчетыССотрудниками.КонечныйОстаток <> 0
		|				ТОГДА ИСТИНА
		|			КОГДА КадровыеДанныеГоловныхСотрудников.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
		|				ТОГДА ИСТИНА
		|			КОГДА КадровыеДанныеГоловныхСотрудников.ДатаУвольнения >= НАЧАЛОПЕРИОДА(БухгалтерскиеВзаиморасчетыССотрудниками.Период, МЕСЯЦ)
		|				ТОГДА ИСТИНА
		|			ИНАЧЕ ЛОЖЬ
		|		КОНЕЦ
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ПодразделенияСортировкиСотрудников.ОрганизацияСортировки КАК ОрганизацияСортировки,
		|	ПодразделенияСортировкиСотрудников.ПодразделениеСортировки КАК ПодразделениеСортировки,
		|	КадровыеДанныеСотрудников.ПриоритетРабочегоМеста КАК ПриоритетРабочегоМеста,
		|	НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) КАК МесяцНачисления,
		|	ВзаиморасчетыССотрудниками.ФизическоеЛицо КАК ФизическоеЛицо,
		|	ВзаиморасчетыССотрудниками.СтатьяФинансирования КАК СтатьяФинансирования,
		|	ВзаиморасчетыССотрудниками.СтатьяРасходов КАК СтатьяРасходов,
		|	ВзаиморасчетыССотрудниками.Подразделение КАК Подразделение,
		|	ВзаиморасчетыССотрудниками.ГруппаНачисленияУдержанияВыплаты КАК Группа,
		|	ВзаиморасчетыССотрудниками.ВидВзаиморасчетов КАК ВидРасчета,
		|	ВзаиморасчетыССотрудниками.СуммаВзаиморасчетов КАК Сумма,
		|	ВЫБОР
		|		КОГДА НЕ ВзаиморасчетыССотрудниками.Подразделение.Владелец ЕСТЬ NULL
		|			ТОГДА ВзаиморасчетыССотрудниками.Подразделение.Владелец
		|		КОГДА КадровыеДанныеСотрудников.Организация <> ЗНАЧЕНИЕ(СПРАВОЧНИК.Организации.ПустаяСсылка)
		|			ТОГДА КадровыеДанныеСотрудников.Организация
		|		ИНАЧЕ ВзаиморасчетыССотрудниками.Организация
		|	КОНЕЦ КАК Организация,
		|	ВзаиморасчетыССотрудниками.Сотрудник КАК Сотрудник,
		|	ВЫРАЗИТЬ(ВзаиморасчетыССотрудниками.Сотрудник КАК Справочник.Сотрудники).ГоловнойСотрудник КАК ГоловнойСотрудник,
		|	КадровыеДанныеГоловныхСотрудников.ФИОПолные КАК ФИОПолные,
		|	КадровыеДанныеГоловныхСотрудников.ФамилияИО КАК ФамилияИО,
		|	КадровыеДанныеГоловныхСотрудников.Фамилия КАК Фамилия,
		|	КадровыеДанныеГоловныхСотрудников.Имя КАК Имя,
		|	КадровыеДанныеГоловныхСотрудников.Отчество КАК Отчество,
		|	КадровыеДанныеГоловныхСотрудников.Должность КАК ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Организация КАК ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Подразделение КАК ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.ВидЗанятости КАК ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	НАЧАЛОПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) КАК ПериодДействия,
		|	ВзаиморасчетыССотрудниками.Регистратор КАК Регистратор,
		|	КадровыеДанныеСотрудников.Подразделение КАК ПодразделениеНаКонецПериода,
		|	КадровыеДанныеСотрудников.ВидЗанятости КАК ВидЗанятостиНаКонецПериода,
		|	КадровыеДанныеСотрудников.Должность КАК ДолжностьНаКонецПериода,
		|	ВЫБОР
		|		КОГДА КадровыеДанныеСотрудников.ДатаУвольнения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И КадровыеДанныеСотрудников.ДатаУвольнения <= КадровыеДанныеСотрудников.Период
		|			ТОГДА КадровыеДанныеСотрудников.ТекущаяТарифнаяСтавка
		|		ИНАЧЕ КадровыеДанныеСотрудников.ТарифнаяСтавка
		|	КОНЕЦ КАК ТарифнаяСтавкаНаКонецПериода,
		|	КадровыеДанныеСотрудников.ВидЗанятости КАК ВидЗанятости,
		|	КадровыеДанныеСотрудников.Должность КАК Должность,
		|	КадровыеДанныеСотрудников.ТарифнаяСтавка КАК ТарифнаяСтавка,
		|	КадровыеДанныеГоловныхСотрудников.ДатаПриема КАК ДатаПриема,
		|	КадровыеДанныеГоловныхСотрудников.ДатаУвольнения КАК ДатаУвольнения
		|ПОМЕСТИТЬ ВТДвиженияБухгалтерскихВзаиморасчетов
		|ИЗ
		|	РегистрНакопления.БухгалтерскиеВзаиморасчетыССотрудниками КАК ВзаиморасчетыССотрудниками
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудников
		|		ПО ВзаиморасчетыССотрудниками.Сотрудник = КадровыеДанныеСотрудников.Сотрудник
		|			И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = КадровыеДанныеСотрудников.Период)}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеГоловныхСотрудников
		|		ПО (ВЫРАЗИТЬ(ВзаиморасчетыССотрудниками.Сотрудник КАК Справочник.Сотрудники).ГоловнойСотрудник = КадровыеДанныеГоловныхСотрудников.Сотрудник)
		|			И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = КадровыеДанныеГоловныхСотрудников.Период)}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_ПодразделенияСортировкиСотрудников КАК ПодразделенияСортировкиСотрудников
		|		ПО ВзаиморасчетыССотрудниками.ФизическоеЛицо = ПодразделенияСортировкиСотрудников.ФизическоеЛицо
		|			И ВзаиморасчетыССотрудниками.Организация.ГоловнаяОрганизация = ПодразделенияСортировкиСотрудников.ГоловнаяОрганизация
		|			И (КОНЕЦПЕРИОДА(ВзаиморасчетыССотрудниками.Период, МЕСЯЦ) = ПодразделенияСортировкиСотрудников.Период)}
		|ГДЕ
		|	ВзаиморасчетыССотрудниками.Период МЕЖДУ &НачалоПериода И &КонецПериода
		|	И ВзаиморасчетыССотрудниками.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
		|	И ВзаиморасчетыССотрудниками.ВидВзаиморасчетов <> ЗНАЧЕНИЕ(Перечисление.ВидыВзаиморасчетовССотрудниками.ПустаяСсылка)
		|	И НЕ ВзаиморасчетыССотрудниками.Регистратор В (&ИсключаемыеСсылки)
		|{ГДЕ
		|	ВзаиморасчетыССотрудниками.Сотрудник.*,
		|	ВзаиморасчетыССотрудниками.ФизическоеЛицо.*,
		|	ВзаиморасчетыССотрудниками.Организация.*,
		|	ВзаиморасчетыССотрудниками.Сотрудник.ГоловнойСотрудник.* КАК ГоловнойСотрудник}
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НачисленияИУдержания.Регистратор КАК Регистратор,
		|	НачисленияИУдержания.ВидРасчета КАК ВидРасчета,
		|	НачисленияИУдержания.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	АВТОНОМЕРЗАПИСИ() КАК НомерЗаписи
		|ПОМЕСТИТЬ ВТНомераЗаписей
		|ИЗ
		|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
		|		НачисленияИУдержания.Регистратор КАК Регистратор,
		|		НачисленияИУдержания.ВидРасчета КАК ВидРасчета,
		|		НачисленияИУдержания.ИдентификаторСтроки КАК ИдентификаторСтроки
		|	ИЗ
		|		ВТНачисленияИУдержанияБезКадровыхДанных КАК НачисленияИУдержания) КАК НачисленияИУдержания
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ПодразделенияСортировкиСотрудников.ОрганизацияСортировки КАК ОрганизацияСортировки,
		|	ПодразделенияСортировкиСотрудников.ПодразделениеСортировки КАК ПодразделениеСортировки,
		|	КадровыеДанныеСотрудниковНаКонецПериода.ПриоритетРабочегоМеста КАК ПриоритетРабочегоМеста,
		|	НачисленияИУдержания.МесяцНачисления КАК МесяцНачисления,
		|	НачисленияИУдержания.ФизическоеЛицо КАК ФизическоеЛицо,
		|	НачисленияИУдержания.СтатьяФинансирования КАК СтатьяФинансирования,
		|	НачисленияИУдержания.СтатьяРасходов КАК СтатьяРасходов,
		|	НачисленияИУдержания.Подразделение КАК Подразделение,
		|	НачисленияИУдержания.Группа КАК Группа,
		|	НачисленияИУдержания.ВидРасчета КАК ВидРасчета,
		|	НачисленияИУдержания.Сумма КАК Сумма,
		|	НачисленияИУдержания.Организация КАК Организация,
		|	НачисленияИУдержания.Сотрудник КАК Сотрудник,
		|	НачисленияИУдержания.ДатаНачала КАК ДатаНачала,
		|	НачисленияИУдержания.ДатаОкончания КАК ДатаОкончания,
		|	НачисленияИУдержания.ГоловнойСотрудник КАК ГоловнойСотрудник,
		|	КадровыеДанныеГоловныхСотрудников.ФИОПолные КАК ФИОПолные,
		|	КадровыеДанныеГоловныхСотрудников.ФамилияИО КАК ФамилияИО,
		|	КадровыеДанныеГоловныхСотрудников.Фамилия КАК Фамилия,
		|	КадровыеДанныеГоловныхСотрудников.Имя КАК Имя,
		|	КадровыеДанныеГоловныхСотрудников.Отчество КАК Отчество,
		|	КадровыеДанныеГоловныхСотрудников.Должность КАК ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Организация КАК ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.Подразделение КАК ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	КадровыеДанныеГоловныхСотрудников.ВидЗанятости КАК ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	НачисленияИУдержания.ПериодДействия КАК ПериодДействия,
		|	НачисленияИУдержания.Регистратор КАК Регистратор,
		|	КадровыеДанныеСотрудниковНаКонецПериода.Подразделение КАК ПодразделениеНаКонецПериода,
		|	КадровыеДанныеСотрудниковНаКонецПериода.ВидЗанятости КАК ВидЗанятостиНаКонецПериода,
		|	КадровыеДанныеСотрудниковНаКонецПериода.Должность КАК ДолжностьНаКонецПериода,
		|	КадровыеДанныеСотрудников.Должность КАК Должность,
		|	ВЫБОР
		|		КОГДА КадровыеДанныеСотрудниковНаКонецПериода.ДатаУвольнения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И КадровыеДанныеСотрудниковНаКонецПериода.ДатаУвольнения <= КадровыеДанныеСотрудниковНаКонецПериода.Период
		|			ТОГДА КадровыеДанныеСотрудниковНаКонецПериода.ТекущаяТарифнаяСтавка
		|		ИНАЧЕ КадровыеДанныеСотрудниковНаКонецПериода.ТарифнаяСтавка
		|	КОНЕЦ КАК ТарифнаяСтавкаНаКонецПериода,
		|	КадровыеДанныеСотрудников.ТарифнаяСтавка КАК ТарифнаяСтавка,
		|	КадровыеДанныеСотрудников.ВидЗанятости КАК ВидЗанятости,
		|	NULL КАК Показатель,
		|	0 КАК Значение,
		|	NULL КАК ПорядокПоказателей,
		|	ИСТИНА КАК ПервыйПоказатель,
		|	КадровыеДанныеГоловныхСотрудников.ДатаПриема КАК ДатаПриема,
		|	КадровыеДанныеГоловныхСотрудников.ДатаУвольнения КАК ДатаУвольнения,
		|	НачисленияИУдержания.ДокументОснование КАК ДокументОснование,
		|	НачисленияИУдержания.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	НачисленияИУдержания.Сторно КАК Сторно,
		|	НачисленияИУдержания.НачислениеТекущегоПериода КАК НачислениеТекущегоПериода,
		|	ВЫБОР
		|		КОГДА ТИПЗНАЧЕНИЯ(НачисленияИУдержания.ВидРасчета) = ТИП(ПланВидовРасчета.Начисления)
		|				ИЛИ ТИПЗНАЧЕНИЯ(НачисленияИУдержания.ВидРасчета) = ТИП(ПланВидовРасчета.Удержания)
		|			ТОГДА НачисленияИУдержания.ВидРасчета.РеквизитДопУпорядочивания * 10000000000000000 + ВЫБОР
		|					КОГДА &ВыводитьПериодыНачислений
		|						ТОГДА РАЗНОСТЬДАТ(ДАТАВРЕМЯ(2000, 1, 1), ВЫБОР
		|									КОГДА ЕСТЬNULL(НачисленияИУдержания.ДатаНачала, ДАТАВРЕМЯ(1, 1, 1)) < ДАТАВРЕМЯ(2000, 1, 1)
		|										ТОГДА ДАТАВРЕМЯ(2000, 1, 1)
		|									ИНАЧЕ НачисленияИУдержания.ДатаНачала
		|								КОНЕЦ, ДЕНЬ) * 100000000000 + РАЗНОСТЬДАТ(ДАТАВРЕМЯ(2000, 1, 1), ВЫБОР
		|									КОГДА ЕСТЬNULL(НачисленияИУдержания.ДатаОкончания, ДАТАВРЕМЯ(1, 1, 1)) < ДАТАВРЕМЯ(2000, 1, 1)
		|										ТОГДА ДАТАВРЕМЯ(2000, 1, 1)
		|									ИНАЧЕ НачисленияИУдержания.ДатаОкончания
		|								КОНЕЦ, ДЕНЬ) * 1000000
		|					ИНАЧЕ 0
		|				КОНЕЦ + ВЫБОР
		|					КОГДА &ВыводитьПоказателиНачисленийИУдержаний
		|							ИЛИ &ВыводитьВсеПоказателиНачисленийИУдержаний
		|						ТОГДА НомераЗаписей.НомерЗаписи
		|					ИНАЧЕ 0
		|				КОНЕЦ
		|		ИНАЧЕ НачисленияИУдержания.ВидРасчета.Порядок
		|	КОНЕЦ КАК ПриоритетВидаРасчета
		|ПОМЕСТИТЬ ВТНачисленияИУдержанияСКадровымиДанными
		|ИЗ
		|	ВТНачисленияИУдержанияБезКадровыхДанных КАК НачисленияИУдержания
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНомераЗаписей КАК НомераЗаписей
		|		ПО НачисленияИУдержания.Регистратор = НомераЗаписей.Регистратор
		|			И НачисленияИУдержания.ВидРасчета = НомераЗаписей.ВидРасчета
		|			И НачисленияИУдержания.ИдентификаторСтроки = НомераЗаписей.ИдентификаторСтроки
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудниковНаКонецПериода
		|		ПО НачисленияИУдержания.Сотрудник = КадровыеДанныеСотрудниковНаКонецПериода.Сотрудник
		|			И (КОНЕЦПЕРИОДА(НачисленияИУдержания.МесяцНачисления, МЕСЯЦ) = КадровыеДанныеСотрудниковНаКонецПериода.Период)}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудников
		|		ПО НачисленияИУдержания.Сотрудник = КадровыеДанныеСотрудников.Сотрудник
		|			И (ВЫБОР
		|				КОГДА НачисленияИУдержания.ДатаНачала = ДАТАВРЕМЯ(1, 1, 1)
		|						ИЛИ НачисленияИУдержания.ДатаНачала > КОНЕЦПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ)
		|					ТОГДА КОНЕЦПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ)
		|				ИНАЧЕ НачисленияИУдержания.ДатаНачала
		|			КОНЕЦ = КадровыеДанныеСотрудников.Период)}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеГоловныхСотрудников
		|		ПО (ВЫРАЗИТЬ(НачисленияИУдержания.Сотрудник КАК Справочник.Сотрудники).ГоловнойСотрудник = КадровыеДанныеГоловныхСотрудников.Сотрудник)
		|			И (КОНЕЦПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ) = КадровыеДанныеГоловныхСотрудников.Период)}
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_ПодразделенияСортировкиСотрудников КАК ПодразделенияСортировкиСотрудников
		|		ПО НачисленияИУдержания.ФизическоеЛицо = ПодразделенияСортировкиСотрудников.ФизическоеЛицо
		|			И (КОНЕЦПЕРИОДА(НачисленияИУдержания.Период, МЕСЯЦ) = ПодразделенияСортировкиСотрудников.Период)
		|			И НачисленияИУдержания.ГоловнаяОрганизация = ПодразделенияСортировкиСотрудников.ГоловнаяОрганизация}
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ДАТАВРЕМЯ(1, 1, 1) КАК МесяцНачисления,
		|	ДАТАВРЕМЯ(1, 1, 1) КАК ПериодДействия,
		|	НЕОПРЕДЕЛЕНО КАК Регистратор,
		|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК Организация,
		|	ЗНАЧЕНИЕ(Справочник.Сотрудники.ПустаяСсылка) КАК Сотрудник,
		|	ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка) КАК Подразделение,
		|	ЗНАЧЕНИЕ(ПланВидовРасчета.Начисления.ПустаяСсылка) КАК ВидРасчета,
		|	0 КАК ОтработаноДней,
		|	0 КАК ОтработаноЧасов,
		|	0 КАК ОтработаноДнейВПериоде,
		|	0 КАК ОтработаноЧасовВПериоде,
		|	0 КАК ОплаченоДней,
		|	0 КАК ОплаченоЧасов,
		|	ДАТАВРЕМЯ(1, 1, 1) КАК ДатаНачала,
		|	ЗНАЧЕНИЕ(Справочник.СтатьиФинансированияЗарплата.ПустаяСсылка) КАК СтатьяФинансирования,
		|	ЛОЖЬ КАК ВремяВЧасах,
		|	ЗНАЧЕНИЕ(Справочник.СтатьиРасходовЗарплата.ПустаяСсылка) КАК СтатьяРасходов,
		|	НЕОПРЕДЕЛЕНО КАК ДокументОснование,
		|	0 КАК ИдентификаторСтроки
		|ПОМЕСТИТЬ Представления_ОтработанноеВремя
		|ИЗ
		|	ВТНачисленияИУдержанияБезКадровыхДанных КАК НачисленияИУдержания
		|ГДЕ
		|	""НачалоПериода"" = &НачалоПериода
		|	И ""ОкончаниеПериода"" = &КонецПериода
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ДанныеСотрудников.ОрганизацияСортировки КАК ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки КАК ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста КАК ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.МесяцНачисления КАК МесяцНачисления,
		|	ДанныеСотрудников.ФизическоеЛицо КАК ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования КАК СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов КАК СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение КАК Подразделение,
		|	ДанныеСотрудников.Группа КАК Группа,
		|	ДанныеСотрудников.ВидРасчета КАК ВидРасчета,
		|	ДанныеСотрудников.ДокументОснование КАК ДокументОснование,
		|	ДанныеСотрудников.Сумма КАК Сумма,
		|	ДанныеСотрудников.ДатаНачала КАК ДатаНачала,
		|	ДанныеСотрудников.ДатаОкончания КАК ДатаОкончания,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОтработаноДней, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ОтработаноДней,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОтработаноЧасов, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ОтработаноЧасов,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОтработаноДнейВПериоде, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ОтработаноДнейВПериоде,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОтработаноЧасовВПериоде, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ОтработаноЧасовВПериоде,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОплаченоДней, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ОплаченоДней,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОплаченоЧасов, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ОплаченоЧасов,
		|	ДанныеСотрудников.Организация КАК Организация,
		|	ДанныеСотрудников.Сотрудник КАК Сотрудник,
		|	ДанныеСотрудников.ФИОПолные КАК ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО КАК ФамилияИО,
		|	ДанныеСотрудников.Фамилия КАК Фамилия,
		|	ДанныеСотрудников.Имя КАК Имя,
		|	ДанныеСотрудников.Отчество КАК Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник КАК ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода КАК ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода КАК ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода КАК ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода КАК ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПериодДействия КАК ПериодДействия,
		|	ДанныеСотрудников.Регистратор КАК Регистратор,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода КАК ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода КАК ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода КАК ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавкаНаКонецПериода КАК ТарифнаяСтавкаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятости КАК ВидЗанятости,
		|	ДанныеСотрудников.Должность КАК Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка КАК ТарифнаяСтавка,
		|	ОтработанноеВремя.ВремяВЧасах КАК ВремяВЧасах,
		|	ДанныеСотрудников.Показатель КАК Показатель,
		|	ДанныеСотрудников.Значение КАК Значение,
		|	ДанныеСотрудников.ПорядокПоказателей КАК ПорядокПоказателей,
		|	ДанныеСотрудников.ДатаПриема КАК ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения КАК ДатаУвольнения,
		|	ДанныеСотрудников.Сторно КАК Сторно,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО) КАК ПервыйМесяц,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО) КАК ПоследнийМесяц,
		|	ДанныеСотрудников.ПриоритетВидаРасчета КАК ПриоритетВидаРасчета
		|ПОМЕСТИТЬ ОбщиеЗапросы_НачисленияУдержания
		|ИЗ
		|	ВТНачисленияИУдержанияСКадровымиДанными КАК ДанныеСотрудников
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_ОтработанноеВремя КАК ОтработанноеВремя
		|		ПО ДанныеСотрудников.Регистратор = ОтработанноеВремя.Регистратор
		|			И ДанныеСотрудников.Организация = ОтработанноеВремя.Организация
		|			И ДанныеСотрудников.Сотрудник = ОтработанноеВремя.Сотрудник
		|			И ДанныеСотрудников.Подразделение = ОтработанноеВремя.Подразделение
		|			И ДанныеСотрудников.ВидРасчета = ОтработанноеВремя.ВидРасчета
		|			И ДанныеСотрудников.МесяцНачисления = ОтработанноеВремя.МесяцНачисления
		|			И ДанныеСотрудников.СтатьяФинансирования = ОтработанноеВремя.СтатьяФинансирования
		|			И ДанныеСотрудников.СтатьяРасходов = ОтработанноеВремя.СтатьяРасходов
		|			И ДанныеСотрудников.ИдентификаторСтроки = ОтработанноеВремя.ИдентификаторСтроки}
		|ГДЕ
		|	ДанныеСотрудников.НачислениеТекущегоПериода
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.МесяцНачисления,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ДанныеСотрудников.Группа,
		|	ДанныеСотрудников.ВидРасчета,
		|	ДанныеСотрудников.ДокументОснование,
		|	ДанныеСотрудников.Сумма,
		|	ДанныеСотрудников.ДатаНачала,
		|	ДанныеСотрудников.ДатаОкончания,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОтработаноДней, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОтработаноЧасов, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОтработаноДнейВПериоде, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОтработаноЧасовВПериоде, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОплаченоДней, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ДанныеСотрудников.ПервыйПоказатель
		|			ТОГДА ЕСТЬNULL(ОтработанноеВремя.ОплаченоЧасов, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПериодДействия,
		|	ДанныеСотрудников.Регистратор,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавкаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ОтработанноеВремя.ВремяВЧасах,
		|	ДанныеСотрудников.Показатель,
		|	ДанныеСотрудников.Значение,
		|	ДанныеСотрудников.ПорядокПоказателей,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ДанныеСотрудников.Сторно,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ДанныеСотрудников.ПриоритетВидаРасчета
		|ИЗ
		|	ВТНачисленияИУдержанияСКадровымиДанными КАК ДанныеСотрудников
		|		{ЛЕВОЕ СОЕДИНЕНИЕ Представления_ОтработанноеВремя КАК ОтработанноеВремя
		|		ПО ДанныеСотрудников.Регистратор = ОтработанноеВремя.Регистратор
		|			И ДанныеСотрудников.Организация = ОтработанноеВремя.Организация
		|			И ДанныеСотрудников.Сотрудник = ОтработанноеВремя.Сотрудник
		|			И ДанныеСотрудников.Подразделение = ОтработанноеВремя.Подразделение
		|			И ДанныеСотрудников.ВидРасчета = ОтработанноеВремя.ВидРасчета
		|			И ДанныеСотрудников.МесяцНачисления = ОтработанноеВремя.МесяцНачисления
		|			И ДанныеСотрудников.СтатьяФинансирования = ОтработанноеВремя.СтатьяФинансирования
		|			И ДанныеСотрудников.СтатьяРасходов = ОтработанноеВремя.СтатьяРасходов
		|			И ДанныеСотрудников.ИдентификаторСтроки = ОтработанноеВремя.ИдентификаторСтроки}
		|ГДЕ
		|	НЕ ДанныеСотрудников.НачислениеТекущегоПериода
		|	И НЕ ОтработанноеВремя.МесяцНачисления ЕСТЬ NULL
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.МесяцНачисления,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.ВыплаченоПоМесяцамРасчета),
		|	ДанныеСотрудников.ВидРасчета,
		|	NULL,
		|	ДанныеСотрудников.Сумма,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПериодДействия,
		|	ДанныеСотрудников.Регистратор,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавкаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	0
		|ИЗ
		|	ВТДвиженияВзаиморасчетов КАК ДанныеСотрудников
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.МесяцНачисления,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.Выплачено),
		|	ДанныеСотрудников.ВидРасчета,
		|	NULL,
		|	ДанныеСотрудников.Сумма,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПериодДействия,
		|	ДанныеСотрудников.Регистратор,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавкаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	0
		|ИЗ
		|	ВТДвиженияВзаиморасчетов КАК ДанныеСотрудников
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.МесяцНачисления,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.ВыплаченоПоБухучету),
		|	ДанныеСотрудников.ВидРасчета,
		|	NULL,
		|	ДанныеСотрудников.Сумма,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПериодДействия,
		|	ДанныеСотрудников.Регистратор,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавкаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	0
		|ИЗ
		|	ВТДвиженияБухгалтерскихВзаиморасчетов КАК ДанныеСотрудников
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.Период,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.КонечноеСальдоПоМесяцамРасчета),
		|	NULL,
		|	NULL,
		|	ДанныеСотрудников.КонечныйОстаток,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	NULL,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ДанныеСотрудников.ПервыйМесяц,
		|	ДанныеСотрудников.ПоследнийМесяц,
		|	0
		|ИЗ
		|	ВТСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.Период,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.НачальноеСальдоПоМесяцамРасчета),
		|	NULL,
		|	NULL,
		|	ДанныеСотрудников.НачальныйОстаток,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	NULL,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ДанныеСотрудников.ПервыйМесяц,
		|	ДанныеСотрудников.ПоследнийМесяц,
		|	0
		|ИЗ
		|	ВТСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.Период,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.КонечноеСальдо),
		|	NULL,
		|	NULL,
		|	ДанныеСотрудников.КонечныйОстаток,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	NULL,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ДанныеСотрудников.ПервыйМесяц,
		|	ДанныеСотрудников.ПоследнийМесяц,
		|	0
		|ИЗ
		|	ВТСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.Период,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.НачальноеСальдо),
		|	NULL,
		|	NULL,
		|	ДанныеСотрудников.НачальныйОстаток,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	NULL,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ДанныеСотрудников.ПервыйМесяц,
		|	ДанныеСотрудников.ПоследнийМесяц,
		|	0
		|ИЗ
		|	ВТСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.Период,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.КонечноеСальдоПоБухучету),
		|	NULL,
		|	NULL,
		|	ДанныеСотрудников.КонечныйОстаток,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	NULL,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ДанныеСотрудников.ПервыйМесяц,
		|	ДанныеСотрудников.ПоследнийМесяц,
		|	0
		|ИЗ
		|	ВТБухгалтерскоеСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.Период,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.НачальноеСальдоПоБухучету),
		|	NULL,
		|	NULL,
		|	ДанныеСотрудников.НачальныйОстаток,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	NULL,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ДанныеСотрудников.ПервыйМесяц,
		|	ДанныеСотрудников.ПоследнийМесяц,
		|	0
		|ИЗ
		|	ВТБухгалтерскоеСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.Период,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.КонечноеСальдоПериода),
		|	NULL,
		|	NULL,
		|	ДанныеСотрудников.КонечныйОстаток,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	NULL,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ДанныеСотрудников.ПервыйМесяц,
		|	ДанныеСотрудников.ПоследнийМесяц,
		|	0
		|ИЗ
		|	ВТСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников
		|ГДЕ
		|	ЕСТЬNULL(ДанныеСотрудников.ПоследнийМесяц, ДАТАВРЕМЯ(1, 1, 1)) = ДанныеСотрудников.Период
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ДанныеСотрудников.ОрганизацияСортировки,
		|	ДанныеСотрудников.ПодразделениеСортировки,
		|	ДанныеСотрудников.ПриоритетРабочегоМеста,
		|	ДанныеСотрудников.Период,
		|	ДанныеСотрудников.ФизическоеЛицо,
		|	ДанныеСотрудников.СтатьяФинансирования,
		|	ДанныеСотрудников.СтатьяРасходов,
		|	ДанныеСотрудников.Подразделение,
		|	ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты.НачальноеСальдоПериода),
		|	NULL,
		|	NULL,
		|	ДанныеСотрудников.НачальныйОстаток,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	0,
		|	ДанныеСотрудников.Организация,
		|	ДанныеСотрудников.Сотрудник,
		|	ДанныеСотрудников.ФИОПолные,
		|	ДанныеСотрудников.ФамилияИО,
		|	ДанныеСотрудников.Фамилия,
		|	ДанныеСотрудников.Имя,
		|	ДанныеСотрудников.Отчество,
		|	ДанныеСотрудников.ГоловнойСотрудник,
		|	ДанныеСотрудников.ДолжностьГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ОрганизацияГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ПодразделениеГоловногоСотрудникаНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиГоловногоСотрудникаНаКонецПериода,
		|	ВЫРАЗИТЬ(NULL КАК ДАТА),
		|	NULL,
		|	ДанныеСотрудников.ПодразделениеНаКонецПериода,
		|	ДанныеСотрудников.ВидЗанятостиНаКонецПериода,
		|	ДанныеСотрудников.ДолжностьНаКонецПериода,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ДанныеСотрудников.ВидЗанятости,
		|	ДанныеСотрудников.Должность,
		|	ДанныеСотрудников.ТарифнаяСтавка,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	NULL,
		|	0,
		|	NULL,
		|	ДанныеСотрудников.ДатаПриема,
		|	ДанныеСотрудников.ДатаУвольнения,
		|	ВЫРАЗИТЬ(NULL КАК БУЛЕВО),
		|	ДанныеСотрудников.ПервыйМесяц,
		|	ДанныеСотрудников.ПоследнийМесяц,
		|	0
		|ИЗ
		|	ВТСальдоПоРасчетамССотрудниками КАК ДанныеСотрудников
		|ГДЕ
		|	ЕСТЬNULL(ДанныеСотрудников.ПервыйМесяц, ДАТАВРЕМЯ(1, 1, 1)) = ДанныеСотрудников.Период";
		
		ВариантСальдо = РегистрыСведений.ДополнительныеНастройкиЗарплатаКадры.ОтражениеВзаиморасчетовССотрудниками();
		Если ВариантСальдо = Перечисления.ВариантыОтраженияВзаиморасчетовССотрудниками.ПоДаннымБухучета Тогда
			ЗаменитьИмяТаблицыДляАвтоПолей(ТекстЗапроса, "КонечноеСальдо", "ВТСальдоПоРасчетамССотрудниками", "ВТБухгалтерскоеСальдоПоРасчетамССотрудниками");
			ЗаменитьИмяТаблицыДляАвтоПолей(ТекстЗапроса, "НачальноеСальдо", "ВТСальдоПоРасчетамССотрудниками", "ВТБухгалтерскоеСальдоПоРасчетамССотрудниками");
			ЗаменитьИмяТаблицыДляАвтоПолей(ТекстЗапроса, "КонечноеСальдоПериода", "ВТСальдоПоРасчетамССотрудниками", "ВТБухгалтерскоеСальдоПоРасчетамССотрудниками");
			ЗаменитьИмяТаблицыДляАвтоПолей(ТекстЗапроса, "НачальноеСальдоПериода", "ВТСальдоПоРасчетамССотрудниками", "ВТБухгалтерскоеСальдоПоРасчетамССотрудниками");
			ЗаменитьИмяТаблицыДляАвтоПолей(ТекстЗапроса, "Выплачено", "ВТДвиженияВзаиморасчетов", "ВТДвиженияБухгалтерскихВзаиморасчетов");
		КонецЕсли;
		
	КонецЕсли;
	
	Если Не ПустаяСтрока(ТекстЗапроса) И Не ТолькоРазрешенные Тогда
		
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "РАЗРЕШЕННЫЕ", "");
		ТекстЗапроса = СтрЗаменить(ТекстЗапроса, """ТолькоРазрешенные"" = ИСТИНА", """ТолькоРазрешенные"" = ЛОЖЬ");
		
	КонецЕсли;
	
	Возврат ТекстЗапроса;
	
КонецФункции

Процедура ЗаменитьИмяТаблицыДляАвтоПолей(ТекстЗапроса, ИмяГруппы, ИмяЗамещаемойТаблицы, ИмяЗамещающейТаблицы)
	ПозицияНачалаЗамещаемойСтроки = Найти(ТекстЗапроса, "ЗНАЧЕНИЕ(Перечисление.ГруппыНачисленияУдержанияВыплаты." + ИмяГруппы + ")");
	ДлинаИмениТаблицы = СтрДлина(ИмяЗамещаемойТаблицы);
	ДлинаПервойЧастиЗаменяемойСтроки = Найти(Сред(ТекстЗапроса, ПозицияНачалаЗамещаемойСтроки), ИмяЗамещаемойТаблицы) - 1;
	ДлинаЗамещаемойСтроки = ДлинаПервойЧастиЗаменяемойСтроки + ДлинаИмениТаблицы;
	ЗамещаемаяСтрока = Сред(ТекстЗапроса, ПозицияНачалаЗамещаемойСтроки, ДлинаЗамещаемойСтроки);
	ЗамещающаяСтрока = Сред(ТекстЗапроса, ПозицияНачалаЗамещаемойСтроки, ДлинаПервойЧастиЗаменяемойСтроки) + ИмяЗамещающейТаблицы;
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, ЗамещаемаяСтрока, ЗамещающаяСтрока);
КонецПроцедуры

Функция ПолучитьЗапросПоПредставлению(ТекстЗапроса, СоответствиеПараметров) Экспорт
	
	Запрос = Неопределено;
	
	ПозицияСловаПоместить = СтрНайти(ВРег(ТекстЗапроса), ВРег("ПОМЕСТИТЬ "));
	
	ИмяИсточникаДанных = ЗарплатаКадрыОбщиеНаборыДанных.ПервоеСловоНачинаяСПозицииВТексте(ТекстЗапроса, ПозицияСловаПоместить + СтрДлина("ПОМЕСТИТЬ "));
	МассивПодстрокИмениИсточникаДанных = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(ИмяИсточникаДанных, "_");
	ИмяВременнойТаблицы = МассивПодстрокИмениИсточникаДанных[0];
	ИмяПредставления = МассивПодстрокИмениИсточникаДанных[1];
	Если МассивПодстрокИмениИсточникаДанных.Количество() > 2 Тогда
		ИмяПараметра = МассивПодстрокИмениИсточникаДанных[2];
	Иначе
		ИмяПараметра = Неопределено;
	КонецЕсли;
	
	МассивИменВТИсточниковПараметров = ЗарплатаКадрыОбщиеНаборыДанных.МассивИменВТИсточниковПараметров(ТекстЗапроса, ИмяИсточникаДанных);
	ПараметрыЗапроса = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрыЗапроса(ТекстЗапроса, ИмяИсточникаДанных);
	
	ПредставлениеТолькоРазрешенные = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ТолькоРазрешенные", ПараметрыЗапроса);
	ТолькоРазрешенные = ВРег(ПредставлениеТолькоРазрешенные) = ВРег("Истина");
	
	Если ВРег(ИмяПредставления) = ВРег("Периоды") Тогда
		
		НачалоИнтервала = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("НачалоИнтервала", ПараметрыЗапроса);
		ОкончаниеИнтервала = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ОкончаниеИнтервала", ПараметрыЗапроса);
		
		Периодичность = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("Периодичность", ПараметрыЗапроса);
		Если Периодичность = Неопределено Тогда
			Периодичность = ВРег("Месяц");
		КонецЕсли;
		
		ИмяПоляПериод = "Период";
		
		ПредставлениеИспользоватьКонецПериода = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ИспользоватьКонецПериода", ПараметрыЗапроса);
		Если Периодичность = Неопределено Тогда
			ИспользоватьКонецПериода = Ложь;
		Иначе
			ИспользоватьКонецПериода = ВРег(ПредставлениеИспользоватьКонецПериода) = ВРег("Истина");
		КонецЕсли;
		
		Запрос = ЗарплатаКадрыОбщиеНаборыДанных.ЗапросВТПериоды(
			НачалоИнтервала,
			ОкончаниеИнтервала,
			Периодичность,
			ИмяПоляПериод,
			ИмяИсточникаДанных,
			ИспользоватьКонецПериода);
		
	ИначеЕсли ВРег(ИмяПредставления) = ВРег("ТаблицаРегистра")
		ИЛИ ВРег(ИмяПредставления) = ВРег("СрезПоследних")
		ИЛИ ВРег(ИмяПредставления) = ВРег("СрезПервых") Тогда
		
		ИмяРегистра = ИмяПараметра;
		ИмяСоздаваемойТаблицы = ИмяИсточникаДанных;
		
		ИмяВТФильтра = МассивИменВТИсточниковПараметров[0];
		ИзмеренияФильтра = ЗарплатаКадрыОбщиеНаборыДанных.МассивПолейЗапроса(СоответствиеПараметров[ИмяВТФильтра]);
		
		ОписаниеФильтра = ЗарплатаКадрыОбщиеНаборыДанных.ОписаниеФильтраДляСоздатьВТИмяРегистра(ИмяВТФильтра, ИзмеренияФильтра);
		
		Если ВРег(ИмяПредставления) = ВРег("ТаблицаРегистра") Тогда
			ПараметрыПостроения = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрыПостроенияДляСоздатьВТИмяРегистра();
		Иначе
			ПараметрыПостроения = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрыПостроенияДляСоздатьВТИмяРегистраСрез();
		КонецЕсли;
			
		ПараметрыПостроения.Отборы = ЗарплатаКадрыОбщиеНаборыДанных.КоллекцияОтборПоПараметрам(ПараметрыЗапроса);
		
		ПсевдонимыПолейСКД = СокрЛП(Строка(ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ПсевдонимыПолейСКД", ПараметрыЗапроса)));
		Если ПсевдонимыПолейСКД <> "" Тогда
			МассивОпределений = СтрРазделить(ПсевдонимыПолейСКД, ",");
			Для Каждого СтрокаОпределения Из МассивОпределений Цикл
				Позиция = СтрНайти(СтрокаОпределения, " КАК ");
				Если Позиция > 0 Тогда
					ПараметрыПостроения.СоответствиеПсевдонимовПолейСКД.Вставить(СокрЛП(Лев(СтрокаОпределения, Позиция-1)), СокрЛП(Сред(СтрокаОпределения, Позиция+5)));
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		
		ПредставлениеФормироватьСПериодичностьДень = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ПараметрыПостроения_ФормироватьСПериодичностьДень", ПараметрыЗапроса);
		НеФормироватьСПериодичностьДень = ВРег(ПредставлениеФормироватьСПериодичностьДень) = ВРег("ЛОЖЬ");
		Если НеФормироватьСПериодичностьДень Тогда
			ПараметрыПостроения.ФормироватьСПериодичностьДень = Ложь;
		КонецЕсли;
		
		Если ВРег(ИмяПредставления) = ВРег("ТаблицаРегистра") Тогда
			
			ПредставлениеВключатьЗаписиНаНачалоПериода = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ПараметрыПостроения_ВключатьЗаписиНаНачалоПериода", ПараметрыЗапроса);
			ВключатьЗаписиНаНачалоПериода = ВРег(ПредставлениеВключатьЗаписиНаНачалоПериода) = ВРег("Истина");
			
			Если ВключатьЗаписиНаНачалоПериода Тогда
				ПараметрыПостроения.ВключатьЗаписиНаНачалоПериода = Истина;
			КонецЕсли;
			
			Запрос = ЗарплатаКадрыОбщиеНаборыДанных.ЗапросВТИмяРегистра(ИмяРегистра, ТолькоРазрешенные, ОписаниеФильтра, ПараметрыПостроения, ИмяСоздаваемойТаблицы);
			
		ИначеЕсли ВРег(ИмяПредставления) = ВРег("СрезПоследних") Тогда
			Запрос = ЗарплатаКадрыОбщиеНаборыДанных.ЗапросВТИмяРегистраСрез(ИмяРегистра, ТолькоРазрешенные, ОписаниеФильтра, ПараметрыПостроения, Истина, ИмяСоздаваемойТаблицы);
		Иначе
			Запрос = ЗарплатаКадрыОбщиеНаборыДанных.ЗапросВТИмяРегистраСрез(ИмяРегистра, ТолькоРазрешенные, ОписаниеФильтра, ПараметрыПостроения, Ложь, ИмяСоздаваемойТаблицы);
		КонецЕсли;
		
	ИначеЕсли ВРег(ИмяПредставления) = ВРег("КадровыеДанныеФизическихЛиц") Тогда
		
		Отбор = ЗарплатаКадрыОбщиеНаборыДанных.КоллекцияОтборПоПараметрам(ПараметрыЗапроса);
		
		КоллекцияПолей =  ЗарплатаКадрыОбщиеНаборыДанных.МассивПолейЗапроса(Лев(ТекстЗапроса, ПозицияСловаПоместить - 1));
		
		ПоляОтбораФизическихЛиц = КадровыйУчет.ПоляОтбораФизическихЛиц();
		
		ОписательТаблицыОтборов = КадровыйУчет.ОписаниеВременнойТаблицыОтборовФизическихЛиц(
			МассивИменВТИсточниковПараметров[0],
			ПоляОтбораФизическихЛиц.ФизическоеЛицо,
			ПоляОтбораФизическихЛиц.Период);
		
		Запрос = КадровыйУчет.ЗапросВТКадровыеДанныеФизическихЛиц(
			ТолькоРазрешенные,
			ОписательТаблицыОтборов,
			КоллекцияПолей,
			Отбор,
			,
			ИмяИсточникаДанных);
		
	ИначеЕсли ВРег(ИмяПредставления) = ВРег("КадровыеДанныеСотрудников") Тогда
		
		ФормироватьСПериодичностьДень = Истина;
		
		ПредставлениеФормироватьСПериодичностьДень = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ФормироватьСПериодичностьДень", ПараметрыЗапроса);
		Если ВРег(ПредставлениеФормироватьСПериодичностьДень) = ВРег("Ложь") Тогда
			ФормироватьСПериодичностьДень = Ложь;
		КонецЕсли;
		
		Отбор = ЗарплатаКадрыОбщиеНаборыДанных.КоллекцияОтборПоПараметрам(ПараметрыЗапроса);
		
		КоллекцияПолей = ЗарплатаКадрыОбщиеНаборыДанных.МассивПолейЗапроса(Лев(ТекстЗапроса, ПозицияСловаПоместить - 1));
		
		ПоляОтбораСотрудников = КадровыйУчет.ПоляОтбораСотрудников();
		
		ОписательТаблицыОтборов = КадровыйУчет.ОписаниеВременнойТаблицыОтборовСотрудников(
			МассивИменВТИсточниковПараметров[0],
			ПоляОтбораСотрудников.Сотрудник,
			ПоляОтбораСотрудников.Период);
		
		Запрос = КадровыйУчет.ЗапросВТКадровыеДанныеСотрудников(
			ТолькоРазрешенные,
			ОписательТаблицыОтборов,
			КоллекцияПолей,
			Отбор,
			ФормироватьСПериодичностьДень,
			,
			ИмяИсточникаДанных);
		
	ИначеЕсли ВРег(ИмяПредставления) = ВРег("РабочиеМестаСотрудников") Тогда
		
		Организация = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("Организация", ПараметрыЗапроса);
		Подразделение = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("Подразделение", ПараметрыЗапроса);
		ИмяВТИсточникДанных = МассивИменВТИсточниковПараметров[0];
		
		Параметры = КадровыйУчет.ПараметрыДляЗапросВТРабочиеМестаСотрудниковПоВременнойТаблице();
		
		Параметры.Организация = Организация;
		Параметры.Подразделение = Подразделение;
		Параметры.ИмяВТСотрудникиПериоды = ИмяВТИсточникДанных;
		
		Запрос = КадровыйУчет.ЗапросВТРабочиеМестаСотрудниковПоВременнойТаблице(
			ТолькоРазрешенные,
			ИмяИсточникаДанных,
			Параметры);
		
	ИначеЕсли ВРег(ИмяПредставления) = ВРег("СотрудникиОрганизации") Тогда
		
		Организация = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("Организация", ПараметрыЗапроса);
		Подразделение = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("Подразделение", ПараметрыЗапроса);
		
		Если МассивИменВТИсточниковПараметров.Количество() > 0 Тогда
			Параметры = КадровыйУчет.ПараметрыПолученияСотрудниковОрганизацийПоВременнойТаблице();
			Параметры.ИмяВТФизическиеЛица = МассивИменВТИсточниковПараметров[0];
		Иначе
			Параметры = КадровыйУчет.ПараметрыПолученияСотрудниковОрганизацийПоСпискуФизическихЛиц();
		КонецЕсли;
		
		ПредставлениеОтбиратьПоГоловнойОрганизации = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ОтбиратьПоГоловнойОрганизации", ПараметрыЗапроса);
		Параметры.ОтбиратьПоГоловнойОрганизации = ВРег(ПредставлениеОтбиратьПоГоловнойОрганизации) = ВРег("Истина");
		
		Параметры.Организация = Организация;
		Параметры.Подразделение = Подразделение;
		
		НачалоПериода = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("НачалоПериода", ПараметрыЗапроса);
		Если ЗначениеЗаполнено(НачалоПериода) Тогда
			Параметры.НачалоПериода = НачалоПериода;
		КонецЕсли;
		
		ОкончаниеПериода = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ОкончаниеПериода", ПараметрыЗапроса);
		Если ЗначениеЗаполнено(ОкончаниеПериода) Тогда
			Параметры.ОкончаниеПериода = ОкончаниеПериода;
		КонецЕсли;
		
		Параметры.КадровыеДанные = ЗарплатаКадрыОбщиеНаборыДанных.МассивПолейЗапроса(Лев(ТекстЗапроса, ПозицияСловаПоместить - 1));
		
		Запрос = КадровыйУчет.ЗапросВТСотрудникиОрганизации(
			ТолькоРазрешенные,
			ИмяИсточникаДанных,
			Параметры);
		
	ИначеЕсли ВРег(ИмяПредставления) = ВРег("ОтработанноеВремя") Тогда
		
		НачалоПериода = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("НачалоПериода", ПараметрыЗапроса);
		ОкончаниеПериода = ЗарплатаКадрыОбщиеНаборыДанных.ПараметрЗапроса("ОкончаниеПериода", ПараметрыЗапроса);
		
		Запрос = ЗарплатаКадрыОбщиеНаборыДанных.ЗапросВТПредставленияОтработанноеВремя(
			МассивИменВТИсточниковПараметров[0], НачалоПериода, ОкончаниеПериода, ИмяИсточникаДанных);
		
	
	// Представление, обеспечивающее работу отчета АнализНачисленийИУдержаний, рассчитывает на наличие
	// временной таблицы отборов с именем ВТВсеПериодомКадровыхДанных.
	ИначеЕсли ВРег(ИмяПредставления) = ВРег("КадровыеДанныеСотрудниковАнализНачисленийИУдержаний") Тогда
	
		Запрос = ЗарплатаКадрыОбщиеНаборыДанных.ЗапросПредставленияКадровыеДанныеСотрудниковАнализНачисленийИУдержаний(ТекстЗапроса, ТолькоРазрешенные);
	
	// Представление, обеспечивающее работу отчета АнализНачисленийИУдержаний, рассчитывает на набор кадровых данных
	// сотрудников, содержащемся в представлении КадровыеДанныеСотрудниковАнализНачисленийИУдержаний.
	ИначеЕсли ВРег(ИмяПредставления) = ВРег("ПодразделенияСортировкиСотрудников") Тогда
		
		Запрос = ЗарплатаКадрыОбщиеНаборыДанных.ЗапросПредставленияПодразделенияСортировкиСотрудников();
		
	ИначеЕсли ВРег(ИмяПредставления) = ВРег("НачисленныеДоходыНДФЛ") Тогда
 
		Запрос = УчетНачисленнойЗарплаты.ЗапросВТНачисленныеДоходы("Представления_НачисленныеДоходыНДФЛ");
		
	КонецЕсли;
	
	Возврат Запрос;
	
КонецФункции

Процедура ПриПолученииСвойствРегистра(ИмяРегистра, СтруктураОписанияРегистра) Экспорт
	
КонецПроцедуры	

Функция ЗапросВТПредставленияОтработанноеВремя(ИмяВТНачисленияИУдержания, НачалоПериода, ОкончаниеПериода, ИмяВТОтработанноеВремя) Экспорт
	
	Запрос = Новый Запрос;
	
	Запрос.Текст =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	НАЧАЛОПЕРИОДА(ОтработанноеВремя.Период, МЕСЯЦ) КАК МесяцНачисления,
		|	ОтработанноеВремя.ПериодДействия КАК ПериодДействия,
		|	ОтработанноеВремя.Регистратор КАК Регистратор,
		|	ОтработанноеВремя.Сотрудник КАК Сотрудник,
		|	ОтработанноеВремя.Организация КАК Организация,
		|	ОтработанноеВремя.Подразделение КАК Подразделение,
		|	ОтработанноеВремя.Начисление КАК ВидРасчета,
		|	ОтработанноеВремя.ДокументОснование КАК ДокументОснование,
		|	ОтработанноеВремя.ДатаНачала КАК ДатаНачала,
		|	ОтработанноеВремя.ВремяВЧасах КАК ВремяВЧасах,
		|	ОтработанноеВремя.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	СУММА(ОтработанноеВремя.ОтработаноДней) КАК ОтработаноДней,
		|	СУММА(ОтработанноеВремя.ОтработаноЧасов) КАК ОтработаноЧасов,
		|	СУММА(ВЫБОР
		|			КОГДА ОтработанноеВремя.Период = ОтработанноеВремя.ПериодДействия
		|				ТОГДА ОтработанноеВремя.ОтработаноДней
		|			ИНАЧЕ 0
		|		КОНЕЦ) КАК ОтработаноДнейВПериоде,
		|	СУММА(ВЫБОР
		|			КОГДА ОтработанноеВремя.Период = ОтработанноеВремя.ПериодДействия
		|				ТОГДА ОтработанноеВремя.ОтработаноЧасов
		|			ИНАЧЕ 0
		|		КОНЕЦ) КАК ОтработаноЧасовВПериоде,
		|	СУММА(ОтработанноеВремя.ОплаченоДней) КАК ОплаченоДней,
		|	СУММА(ОтработанноеВремя.ОплаченоЧасов) КАК ОплаченоЧасов
		|ПОМЕСТИТЬ ВТПериодыОтработанноеВремя
		|ИЗ
		|	РегистрНакопления.ОтработанноеВремяПоСотрудникам КАК ОтработанноеВремя
		|ГДЕ
		|	ОтработанноеВремя.Период МЕЖДУ &ОтработанноеВремяПараметрНачалоПериода И &ОтработанноеВремяПараметрОкончаниеПериода
		|{ГДЕ
		|	ОтработанноеВремя.Сотрудник.*,
		|	ОтработанноеВремя.ФизическоеЛицо.*,
		|	ОтработанноеВремя.Организация.*,
		|	ОтработанноеВремя.Сотрудник.ГоловнойСотрудник.* КАК ГоловнойСотрудник}
		|
		|СГРУППИРОВАТЬ ПО
		|	ОтработанноеВремя.Регистратор,
		|	ОтработанноеВремя.Сотрудник,
		|	ОтработанноеВремя.Подразделение,
		|	ОтработанноеВремя.Начисление,
		|	ОтработанноеВремя.ВремяВЧасах,
		|	НАЧАЛОПЕРИОДА(ОтработанноеВремя.Период, МЕСЯЦ),
		|	ОтработанноеВремя.ПериодДействия,
		|	ОтработанноеВремя.ДокументОснование,
		|	ОтработанноеВремя.ДатаНачала,
		|	ОтработанноеВремя.ИдентификаторСтроки,
		|	ОтработанноеВремя.Организация
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	НАЧАЛОПЕРИОДА(ОтработанноеВремя.ПериодДействия, МЕСЯЦ),
		|	ОтработанноеВремя.ПериодДействия,
		|	ОтработанноеВремя.Регистратор,
		|	ОтработанноеВремя.Сотрудник,
		|	ОтработанноеВремя.Организация,
		|	ОтработанноеВремя.Подразделение,
		|	ОтработанноеВремя.Начисление,
		|	ОтработанноеВремя.ДокументОснование,
		|	ОтработанноеВремя.ДатаНачала,
		|	ОтработанноеВремя.ВремяВЧасах,
		|	ОтработанноеВремя.ИдентификаторСтроки,
		|	0,
		|	0,
		|	ОтработанноеВремя.ОтработаноДней,
		|	ОтработанноеВремя.ОтработаноЧасов,
		|	0,
		|	0
		|ИЗ
		|	РегистрНакопления.ОтработанноеВремяПоСотрудникам КАК ОтработанноеВремя
		|ГДЕ
		|	ОтработанноеВремя.ПериодДействия МЕЖДУ &ОтработанноеВремяПараметрНачалоПериода И &ОтработанноеВремяПараметрОкончаниеПериода
		|	И ОтработанноеВремя.Период <> ОтработанноеВремя.ПериодДействия
		|{ГДЕ
		|	ОтработанноеВремя.Сотрудник.*,
		|	ОтработанноеВремя.ФизическоеЛицо.*,
		|	ОтработанноеВремя.Организация.*,
		|	ОтработанноеВремя.Сотрудник.ГоловнойСотрудник.* КАК ГоловнойСотрудник}
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОтработанноеВремя.МесяцНачисления КАК МесяцНачисления,
		|	ОтработанноеВремя.ПериодДействия КАК ПериодДействия,
		|	ОтработанноеВремя.Регистратор КАК Регистратор,
		|	ОтработанноеВремя.Сотрудник КАК Сотрудник,
		|	ОтработанноеВремя.Организация КАК Организация,
		|	ОтработанноеВремя.Подразделение КАК Подразделение,
		|	ОтработанноеВремя.ВидРасчета КАК ВидРасчета,
		|	ОтработанноеВремя.ДокументОснование КАК ДокументОснование,
		|	ОтработанноеВремя.ДатаНачала КАК ДатаНачала,
		|	ОтработанноеВремя.ВремяВЧасах КАК ВремяВЧасах,
		|	ОтработанноеВремя.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	ОтработанноеВремя.ОтработаноДней КАК ОтработаноДней,
		|	ОтработанноеВремя.ОтработаноЧасов КАК ОтработаноЧасов,
		|	ОтработанноеВремя.ОтработаноДнейВПериоде КАК ОтработаноДнейВПериоде,
		|	ОтработанноеВремя.ОтработаноЧасовВПериоде КАК ОтработаноЧасовВПериоде,
		|	ОтработанноеВремя.ОплаченоДней КАК ОплаченоДней,
		|	ОтработанноеВремя.ОплаченоЧасов КАК ОплаченоЧасов,
		|	НачисленияИУдержания.СтатьяФинансирования КАК СтатьяФинансирования,
		|	НачисленияИУдержания.СтатьяРасходов КАК СтатьяРасходов
		|ПОМЕСТИТЬ ВТНачисленияОтработанноеВремя
		|ИЗ
		|	ВТПериодыОтработанноеВремя КАК ОтработанноеВремя
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТНачисленияИУдержания КАК НачисленияИУдержания
		|		ПО ОтработанноеВремя.МесяцНачисления = НачисленияИУдержания.МесяцНачисления
		|			И ОтработанноеВремя.Регистратор = НачисленияИУдержания.Регистратор
		|			И ОтработанноеВремя.Сотрудник = НачисленияИУдержания.Сотрудник
		|			И ОтработанноеВремя.Организация = НачисленияИУдержания.Организация
		|			И ОтработанноеВремя.Подразделение = НачисленияИУдержания.Подразделение
		|			И ОтработанноеВремя.ВидРасчета = НачисленияИУдержания.ВидРасчета
		|			И ОтработанноеВремя.ИдентификаторСтроки = НачисленияИУдержания.ИдентификаторСтроки
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОтработанноеВремя.МесяцНачисления КАК МесяцНачисления,
		|	ОтработанноеВремя.ПериодДействия КАК ПериодДействия,
		|	ОтработанноеВремя.Регистратор КАК Регистратор,
		|	ОтработанноеВремя.Сотрудник КАК Сотрудник,
		|	ОтработанноеВремя.Организация КАК Организация,
		|	ОтработанноеВремя.Подразделение КАК Подразделение,
		|	ОтработанноеВремя.ВидРасчета КАК ВидРасчета,
		|	ОтработанноеВремя.ДокументОснование КАК ДокументОснование,
		|	ОтработанноеВремя.ДатаНачала КАК ДатаНачала,
		|	ОтработанноеВремя.ВремяВЧасах КАК ВремяВЧасах,
		|	ОтработанноеВремя.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	ОтработанноеВремя.ОтработаноДней КАК ОтработаноДней,
		|	ОтработанноеВремя.ОтработаноЧасов КАК ОтработаноЧасов,
		|	ОтработанноеВремя.ОтработаноДнейВПериоде КАК ОтработаноДнейВПериоде,
		|	ОтработанноеВремя.ОтработаноЧасовВПериоде КАК ОтработаноЧасовВПериоде,
		|	ОтработанноеВремя.ОплаченоДней КАК ОплаченоДней,
		|	ОтработанноеВремя.ОплаченоЧасов КАК ОплаченоЧасов,
		|	МИНИМУМ(ОтработанноеВремя.СтатьяФинансирования) КАК СтатьяФинансирования
		|ПОМЕСТИТЬ ВТСтатьяФинансированияОтработанноеВремя
		|ИЗ
		|	ВТНачисленияОтработанноеВремя КАК ОтработанноеВремя
		|
		|СГРУППИРОВАТЬ ПО
		|	ОтработанноеВремя.МесяцНачисления,
		|	ОтработанноеВремя.ПериодДействия,
		|	ОтработанноеВремя.Регистратор,
		|	ОтработанноеВремя.Сотрудник,
		|	ОтработанноеВремя.Подразделение,
		|	ОтработанноеВремя.ВидРасчета,
		|	ОтработанноеВремя.ОтработаноДней,
		|	ОтработанноеВремя.ОтработаноЧасов,
		|	ОтработанноеВремя.ОплаченоДней,
		|	ОтработанноеВремя.ОплаченоЧасов,
		|	ОтработанноеВремя.ДатаНачала,
		|	ОтработанноеВремя.ВремяВЧасах,
		|	ОтработанноеВремя.ДокументОснование,
		|	ОтработанноеВремя.ИдентификаторСтроки,
		|	ОтработанноеВремя.Организация,
		|	ОтработанноеВремя.ОтработаноДнейВПериоде,
		|	ОтработанноеВремя.ОтработаноЧасовВПериоде
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОтработанноеВремя.МесяцНачисления КАК МесяцНачисления,
		|	ОтработанноеВремя.ПериодДействия КАК ПериодДействия,
		|	ОтработанноеВремя.Регистратор КАК Регистратор,
		|	ОтработанноеВремя.Сотрудник КАК Сотрудник,
		|	ОтработанноеВремя.Организация КАК Организация,
		|	ОтработанноеВремя.Подразделение КАК Подразделение,
		|	ОтработанноеВремя.ВидРасчета КАК ВидРасчета,
		|	ОтработанноеВремя.ДокументОснование КАК ДокументОснование,
		|	ОтработанноеВремя.ДатаНачала КАК ДатаНачала,
		|	ОтработанноеВремя.ВремяВЧасах КАК ВремяВЧасах,
		|	ОтработанноеВремя.ИдентификаторСтроки КАК ИдентификаторСтроки,
		|	ОтработанноеВремя.ОтработаноДней КАК ОтработаноДней,
		|	ОтработанноеВремя.ОтработаноЧасов КАК ОтработаноЧасов,
		|	ОтработанноеВремя.ОтработаноДнейВПериоде КАК ОтработаноДнейВПериоде,
		|	ОтработанноеВремя.ОтработаноЧасовВПериоде КАК ОтработаноЧасовВПериоде,
		|	ОтработанноеВремя.ОплаченоДней КАК ОплаченоДней,
		|	ОтработанноеВремя.ОплаченоЧасов КАК ОплаченоЧасов,
		|	ОтработанноеВремя.СтатьяФинансирования КАК СтатьяФинансирования,
		|	МИНИМУМ(ОтработанноеВремя.СтатьяРасходов) КАК СтатьяРасходов
		|ПОМЕСТИТЬ ВТОтработанноеВремя
		|ИЗ
		|	ВТНачисленияОтработанноеВремя КАК ОтработанноеВремя
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСтатьяФинансированияОтработанноеВремя КАК ОтработанноеВремяСоСтатьейФинансирования
		|		ПО ОтработанноеВремя.МесяцНачисления = ОтработанноеВремяСоСтатьейФинансирования.МесяцНачисления
		|			И ОтработанноеВремя.Регистратор = ОтработанноеВремяСоСтатьейФинансирования.Регистратор
		|			И ОтработанноеВремя.Сотрудник = ОтработанноеВремяСоСтатьейФинансирования.Сотрудник
		|			И ОтработанноеВремя.Подразделение = ОтработанноеВремяСоСтатьейФинансирования.Подразделение
		|			И ОтработанноеВремя.ВидРасчета = ОтработанноеВремяСоСтатьейФинансирования.ВидРасчета
		|			И ОтработанноеВремя.СтатьяФинансирования = ОтработанноеВремяСоСтатьейФинансирования.СтатьяФинансирования
		|			И ОтработанноеВремя.ИдентификаторСтроки = ОтработанноеВремяСоСтатьейФинансирования.ИдентификаторСтроки
		|
		|СГРУППИРОВАТЬ ПО
		|	ОтработанноеВремя.МесяцНачисления,
		|	ОтработанноеВремя.ПериодДействия,
		|	ОтработанноеВремя.Регистратор,
		|	ОтработанноеВремя.Сотрудник,
		|	ОтработанноеВремя.Подразделение,
		|	ОтработанноеВремя.ВидРасчета,
		|	ОтработанноеВремя.ОтработаноДней,
		|	ОтработанноеВремя.ОтработаноЧасов,
		|	ОтработанноеВремя.ОплаченоДней,
		|	ОтработанноеВремя.ОплаченоЧасов,
		|	ОтработанноеВремя.ДатаНачала,
		|	ОтработанноеВремя.СтатьяФинансирования,
		|	ОтработанноеВремя.ВремяВЧасах,
		|	ОтработанноеВремя.ДокументОснование,
		|	ОтработанноеВремя.ИдентификаторСтроки,
		|	ОтработанноеВремя.Организация,
		|	ОтработанноеВремя.ОтработаноДнейВПериоде,
		|	ОтработанноеВремя.ОтработаноЧасовВПериоде
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ВТПериодыОтработанноеВремя
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ВТНачисленияОтработанноеВремя
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|УНИЧТОЖИТЬ ВТСтатьяФинансированияОтработанноеВремя";
	
	Если ТипЗнч(НачалоПериода) = Тип("Строка") Тогда
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&ОтработанноеВремяПараметрНачалоПериода", НачалоПериода);
	Иначе
		Запрос.УстановитьПараметр("ОтработанноеВремяПараметрНачалоПериода", НачалоПериода);
	КонецЕсли;
	
	Если ТипЗнч(ОкончаниеПериода) = Тип("Строка") Тогда
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&ОтработанноеВремяПараметрОкончаниеПериода", ОкончаниеПериода);
	Иначе
		Запрос.УстановитьПараметр("ОтработанноеВремяПараметрОкончаниеПериода", ОкончаниеПериода);
	КонецЕсли;
	
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "ВТНачисленияИУдержания", ИмяВТНачисленияИУдержания);
	Запрос.Текст = СтрЗаменить(Запрос.Текст, "ВТОтработанноеВремя", ИмяВТОтработанноеВремя);
	
	Возврат Запрос;
	
КонецФункции

Функция ЗапросПредставленияКадровыеДанныеСотрудниковАнализНачисленийИУдержаний(ТекстИсходногоЗапроса, ТолькоРазрешенные) Экспорт
	
	Запрос = Новый Запрос;
	
	ПоляИсходногоЗапроса = ЗарплатаКадрыОбщиеНаборыДанных.ПоляЗапроса(ТекстИсходногоЗапроса);
	
	Запрос.Текст =
		"ВЫБРАТЬ
		|	ДАТАВРЕМЯ(1, 1, 1) КАК Период,
		|	ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка) КАК ФизическоеЛицо,
		|	ЗНАЧЕНИЕ(Справочник.Сотрудники.ПустаяСсылка) КАК Сотрудник,
		|	ЗНАЧЕНИЕ(Справочник.Сотрудники.ПустаяСсылка) КАК ГоловнойСотрудник,
		|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК Организация,
		|	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК ГоловнаяОрганизация,
		|	ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка) КАК Подразделение,
		|	ЗНАЧЕНИЕ(Справочник.Должности.ПустаяСсылка) КАК Должность,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыЗанятости.ПустаяСсылка) КАК ВидЗанятости,
		|	"""" КАК ФИОПолные,
		|	"""" КАК ФамилияИО,
		|	"""" КАК Фамилия,
		|	"""" КАК Имя,
		|	"""" КАК Отчество,
		|	0 КАК ТарифнаяСтавка,
		|	0 КАК ТекущаяТарифнаяСтавка,
		|	ДАТАВРЕМЯ(1, 1, 1) КАК ДатаПриема,
		|	ДАТАВРЕМЯ(1, 1, 1) КАК ДатаУвольнения
		|ПОМЕСТИТЬ Представления_КадровыеДанныеСотрудников
		|ИЗ
		|	ВТВсеПериодомКадровыхДанных КАК Сотрудники
		|ГДЕ
		|	""ТолькоРазрешенные"" = ИСТИНА
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	КадровыеДанныеСотрудников.Период КАК Период,
		|	КадровыеДанныеСотрудников.ФизическоеЛицо КАК ФизическоеЛицо,
		|	КадровыеДанныеСотрудников.Сотрудник КАК Сотрудник,
		|	КадровыеДанныеСотрудников.ГоловнойСотрудник КАК ГоловнойСотрудник,
		|	КадровыеДанныеСотрудников.Организация КАК Организация,
		|	КадровыеДанныеСотрудников.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	КадровыеДанныеСотрудников.Подразделение КАК Подразделение,
		|	КадровыеДанныеСотрудников.Должность КАК Должность,
		|	КадровыеДанныеСотрудников.ВидЗанятости КАК ВидЗанятости,
		|	КадровыеДанныеСотрудников.ФИОПолные КАК ФИОПолные,
		|	КадровыеДанныеСотрудников.ФамилияИО КАК ФамилияИО,
		|	КадровыеДанныеСотрудников.Фамилия КАК Фамилия,
		|	КадровыеДанныеСотрудников.Имя КАК Имя,
		|	КадровыеДанныеСотрудников.Отчество КАК Отчество,
		|	КадровыеДанныеСотрудников.ТарифнаяСтавка КАК ТарифнаяСтавка,
		|	КадровыеДанныеСотрудников.ТекущаяТарифнаяСтавка КАК ТекущаяТарифнаяСтавка,
		|	КадровыеДанныеСотрудников.ДатаПриема КАК ДатаПриема,
		|	КадровыеДанныеСотрудников.ДатаУвольнения КАК ДатаУвольнения,
		|	ВЫБОР
		|		КОГДА КадровыеДанныеСотрудников.ВидЗанятости ЕСТЬ NULL
		|			ТОГДА 99999999999999999
		|		ИНАЧЕ РАЗНОСТЬДАТ(ВЫБОР
		|					КОГДА КадровыеДанныеСотрудников.ДатаУвольнения = ДАТАВРЕМЯ(1, 1, 1)
		|						ТОГДА ДАТАВРЕМЯ(2100, 1, 1)
		|					ИНАЧЕ КадровыеДанныеСотрудников.ДатаУвольнения
		|				КОНЕЦ, ДАТАВРЕМЯ(2100, 1, 1), ДЕНЬ) * 1000000000 + КадровыеДанныеСотрудников.ВидЗанятости.Порядок * 1000000 + РАЗНОСТЬДАТ(ДАТАВРЕМЯ(1900, 1, 1), ВЫБОР
		|					КОГДА КадровыеДанныеСотрудников.ДатаПриема = ДАТАВРЕМЯ(1, 1, 1)
		|						ТОГДА ДАТАВРЕМЯ(1900, 1, 1)
		|					ИНАЧЕ КадровыеДанныеСотрудников.ДатаПриема
		|				КОНЕЦ, ДЕНЬ)
		|	КОНЕЦ КАК ПриоритетРабочегоМеста
		|ПОМЕСТИТЬ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний
		|ИЗ
		|	Представления_КадровыеДанныеСотрудников КАК КадровыеДанныеСотрудников
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Сотрудник";
	
	ТаблицаДополнительныхПолей = ЗарплатаКадрыОбщиеНаборыДанных.ПустаяТаблицаДополнительныхПолейПредставлений();
	Для Каждого ПолеИсходногоЗапроса Из ПоляИсходногоЗапроса Цикл
		
		Если ПолеИсходногоЗапроса.Ключ = "ПриоритетРабочегоМеста" Тогда
			Продолжить;
		КонецЕсли;
		
		СтрокаДополнительногоПоля = ТаблицаДополнительныхПолей.Добавить();
		СтрокаДополнительногоПоля.ИмяПоля = ПолеИсходногоЗапроса.Ключ;
		СтрокаДополнительногоПоля.ПустоеЗначениеНаЯзыкеЗапросов = ПолеИсходногоЗапроса.Значение;
		
	КонецЦикла;
	
	Если ТолькоРазрешенные Тогда
		
		Запрос.Текст = СтрЗаменить(Запрос.Текст,
			"Представления_КадровыеДанныеСотрудников КАК КадровыеДанныеСотрудников",
			"	Представления_КадровыеДанныеСотрудников КАК КадровыеДанныеСотрудников
			|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Организации КАК Организации
			|		ПО (ВЫБОР
			|				КОГДА КадровыеДанныеСотрудников.Организация ЕСТЬ NULL
			|					ТОГДА ИСТИНА
			|				ИНАЧЕ КадровыеДанныеСотрудников.Организация = Организации.Ссылка
			|			КОНЕЦ)");
		
	Иначе
		
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "РАЗРЕШЕННЫЕ", "");
		Запрос.Текст = СтрЗаменить(Запрос.Текст, """ТолькоРазрешенные"" = ИСТИНА", """ТолькоРазрешенные"" = ЛОЖЬ");
		
	КонецЕсли;
	
	ЗарплатаКадрыОбщиеНаборыДанных.ВывестиДополнительныеПоляПредставленийВЗапрос(
		Запрос, ТаблицаДополнительныхПолей, "Представления_КадровыеДанныеСотрудников");
	
	Возврат Запрос;
	
КонецФункции

Функция ЗапросПредставленияПодразделенияСортировкиСотрудников() Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст =
		"ВЫБРАТЬ
		|	КадровыеДанныеСотрудников.Период КАК Период,
		|	КадровыеДанныеСотрудников.ФизическоеЛицо КАК ФизическоеЛицо,
		|	КадровыеДанныеСотрудников.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	МИНИМУМ(КадровыеДанныеСотрудников.ПриоритетРабочегоМеста) КАК ПриоритетРабочегоМеста
		|ПОМЕСТИТЬ ВТВысшиеПриоритетыСотрудников
		|ИЗ
		|	Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудников
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПредставленияКадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудниковПоследние
		|		ПО КадровыеДанныеСотрудников.ФизическоеЛицо = КадровыеДанныеСотрудниковПоследние.ФизическоеЛицо
		|			И КадровыеДанныеСотрудников.ГоловнаяОрганизация = КадровыеДанныеСотрудниковПоследние.ГоловнаяОрганизация
		|			И (НАЧАЛОПЕРИОДА(КадровыеДанныеСотрудников.Период, МЕСЯЦ) = НАЧАЛОПЕРИОДА(КадровыеДанныеСотрудниковПоследние.Период, МЕСЯЦ))
		|
		|СГРУППИРОВАТЬ ПО
		|	КадровыеДанныеСотрудников.Период,
		|	КадровыеДанныеСотрудников.ФизическоеЛицо,
		|	КадровыеДанныеСотрудников.ГоловнаяОрганизация
		|
		|ИМЕЮЩИЕ
		|	КадровыеДанныеСотрудников.Период = МАКСИМУМ(КадровыеДанныеСотрудниковПоследние.Период)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	КадровыеДанныеСотрудников.Период КАК Период,
		|	КадровыеДанныеСотрудников.ФизическоеЛицо КАК ФизическоеЛицо,
		|	КадровыеДанныеСотрудников.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	КадровыеДанныеСотрудников.ПриоритетРабочегоМеста КАК ПриоритетРабочегоМеста,
		|	МИНИМУМ(ВЫБОР
		|			КОГДА ЕСТЬNULL(КадровыеДанныеСотрудниковСПриоритетами.Подразделение, ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА ""9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999""
		|			ИНАЧЕ КадровыеДанныеСотрудниковСПриоритетами.Подразделение.РеквизитДопУпорядочиванияИерархического
		|		КОНЕЦ) КАК ПриоритетПодразделения
		|ПОМЕСТИТЬ ВТВысшиеПриоритетыПодразделенийСотрудников
		|ИЗ
		|	ВТВысшиеПриоритетыСотрудников КАК КадровыеДанныеСотрудников
		|		ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудниковСПриоритетами
		|		ПО КадровыеДанныеСотрудников.Период = КадровыеДанныеСотрудниковСПриоритетами.Период
		|			И КадровыеДанныеСотрудников.ФизическоеЛицо = КадровыеДанныеСотрудниковСПриоритетами.ФизическоеЛицо
		|			И КадровыеДанныеСотрудников.ПриоритетРабочегоМеста = КадровыеДанныеСотрудниковСПриоритетами.ПриоритетРабочегоМеста
		|			И КадровыеДанныеСотрудников.ГоловнаяОрганизация = КадровыеДанныеСотрудниковСПриоритетами.ГоловнаяОрганизация
		|
		|СГРУППИРОВАТЬ ПО
		|	КадровыеДанныеСотрудников.Период,
		|	КадровыеДанныеСотрудников.ФизическоеЛицо,
		|	КадровыеДанныеСотрудников.ПриоритетРабочегоМеста,
		|	КадровыеДанныеСотрудников.ГоловнаяОрганизация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	КОНЕЦПЕРИОДА(КадровыеДанныеСотрудников.Период, МЕСЯЦ) КАК Период,
		|	КадровыеДанныеСотрудников.ФизическоеЛицо КАК ФизическоеЛицо,
		|	КадровыеДанныеСотрудников.ГоловнаяОрганизация КАК ГоловнаяОрганизация,
		|	КадровыеДанныеСотрудниковСПриоритетами.Подразделение КАК ПодразделениеСортировки,
		|	ЕСТЬNULL(КадровыеДанныеСотрудниковСПриоритетами.Организация, КадровыеДанныеСотрудников.ГоловнаяОрганизация) КАК ОрганизацияСортировки
		|ПОМЕСТИТЬ Представления_ПодразделенияСортировкиСотрудников
		|ИЗ
		|	ВТВысшиеПриоритетыПодразделенийСотрудников КАК КадровыеДанныеСотрудников
		|		ЛЕВОЕ СОЕДИНЕНИЕ Представления_КадровыеДанныеСотрудниковАнализНачисленийИУдержаний КАК КадровыеДанныеСотрудниковСПриоритетами
		|		ПО КадровыеДанныеСотрудников.Период = КадровыеДанныеСотрудниковСПриоритетами.Период
		|			И КадровыеДанныеСотрудников.ФизическоеЛицо = КадровыеДанныеСотрудниковСПриоритетами.ФизическоеЛицо
		|			И КадровыеДанныеСотрудников.ПриоритетПодразделения = КадровыеДанныеСотрудниковСПриоритетами.Подразделение.РеквизитДопУпорядочиванияИерархического
		|			И КадровыеДанныеСотрудников.ГоловнаяОрганизация = КадровыеДанныеСотрудниковСПриоритетами.Подразделение.ГоловнаяОрганизация";
	
	Возврат Запрос;
	
КонецФункции

#КонецОбласти
