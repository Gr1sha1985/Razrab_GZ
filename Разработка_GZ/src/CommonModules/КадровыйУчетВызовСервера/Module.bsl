////////////////////////////////////////////////////////////////////////////////
// КадровыйУчетВызовСервера: методы кадрового учета, работающие на стороне сервера.
//  
////////////////////////////////////////////////////////////////////////////////

#Область СлужебныеПроцедурыИФункции

Процедура ИсключитьПовторениеЗаписейТекущихДанныхСотрудников(ИмяРегистраТекущихСведений) Экспорт
	
	КадровыйУчет.ИсключитьПовторениеЗаписейТекущихДанныхСотрудников(ИмяРегистраТекущихСведений);
	
КонецПроцедуры

Процедура ИсключитьЗадвоениеОсновныхРабочихМестТекущихДанныхСотрудников() Экспорт
	
	КадровыйУчет.ИсключитьЗадвоениеОсновныхРабочихМестТекущихДанныхСотрудников();
	
КонецПроцедуры

Функция КадровыеДанныеСотрудника(Сотрудник, КадровыеДанные, Период) Экспорт
	
	Если ТипЗнч(КадровыеДанные) = Тип("Строка") Тогда
		КлючиСтруктуры = "Период,Сотрудник," + КадровыеДанные;
	Иначе
		КлючиСтруктуры = "Период,Сотрудник," + СтрСоединить(КадровыеДанные, ",");
	КонецЕсли;
	
	СтруктураВозврата = Новый Структура(КлючиСтруктуры, Период, Сотрудник);
	
	МассивКадровыхДанных = КадровыеДанныеСотрудников(Сотрудник, КадровыеДанные, Период);
	Если МассивКадровыхДанных.Количество() > 0 Тогда
		Возврат МассивКадровыхДанных[0];
	КонецЕсли;
	
	Возврат Новый ФиксированнаяСтруктура(СтруктураВозврата);
	
КонецФункции

Функция КадровыеДанныеСотрудников(Сотрудники, КадровыеДанные, Период)
	
	Если ТипЗнч(КадровыеДанные) = Тип("Строка") Тогда
		КлючиСтруктуры = "Период,Сотрудник," + КадровыеДанные;
	Иначе
		КлючиСтруктуры = "Период,Сотрудник," + СтрСоединить(КадровыеДанные, ",");
	КонецЕсли;
	
	ВозвращаемыйМассив = Новый Массив;
	ТаблицаКадровыхДанных = КадровыйУчет.КадровыеДанныеСотрудников(Ложь, Сотрудники, КадровыеДанные, Период);
	Для каждого СтрокаТаблицаКадровыхДанных Из ТаблицаКадровыхДанных Цикл
		
		СтруктураВозврата = Новый Структура(КлючиСтруктуры, Период);
		ЗаполнитьЗначенияСвойств(СтруктураВозврата, СтрокаТаблицаКадровыхДанных);
		
		ВозвращаемыйМассив.Добавить(Новый ФиксированнаяСтруктура(СтруктураВозврата));
		
	КонецЦикла;
	
	Возврат Новый ФиксированныйМассив(ВозвращаемыйМассив);
	
КонецФункции

#КонецОбласти
