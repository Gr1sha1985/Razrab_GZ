#Область ОбработчкиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ЭтоПолноправныйПользователь = Пользователи.ЭтоПолноправныйПользователь();
	Элементы.ЗагрузкаИз1СПредприятия77.Видимость = ЭтоПолноправныйПользователь;
	Элементы.ЗагрузкаИзОП.Видимость = ЭтоПолноправныйПользователь;
	ОбработкаЗагрузкаИзДругойУчетнойСистемы = Метаданные.Обработки.ЗагрузкаДанныхИзДругойУчетнойСистемы;
	Элементы.ЗагрузкаИзДругойУчетнойСистемы.Видимость =
		ПравоДоступа("Использование", ОбработкаЗагрузкаИзДругойУчетнойСистемы)
		И ОбщегоНазначения.ОбъектМетаданныхДоступенПоФункциональнымОпциям(ОбработкаЗагрузкаИзДругойУчетнойСистемы);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчкиКомандФормы

&НаКлиенте
Процедура ПерсональныеНастройки(Команда)
	
	ОткрытьФорму("ОбщаяФорма.ПерсональныеНастройки");
	
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузкаИз1СПредприятия77(Команда)
	
	ПараметрыСоединения = СтроковыеФункцииКлиентСервер.ПараметрыИзСтроки(СтрокаСоединенияИнформационнойБазы());
	СистемнаяИнфо = Новый СистемнаяИнформация;
	
	Если ЗначениеЗаполнено(СистемнаяИнфо.ИнформацияПрограммыПросмотра)
		ИЛИ НЕ ПараметрыСоединения.Свойство("File") Тогда
		// веб-клиент или сервер
		ОткрытьФорму("Обработка.ПереносДанныхИзИнформационныхБаз1СПредприятия77.Форма.ФормаЗагрузкаИзФайла");
	Иначе
		// локальный режим
		ОткрытьФорму("Обработка.ПереносДанныхИзИнформационныхБаз1СПредприятия77.Форма");
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузкаИзОП(Команда)
	
	ОткрытьФорму("Обработка.ЗагрузкаДанныхИзОП.Форма");
	
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузкаИзДругойУчетнойСистемы(Команда)
	
	ОткрытьФорму("Обработка.ЗагрузкаДанныхИзДругойУчетнойСистемы.Форма");
	
КонецПроцедуры

#КонецОбласти